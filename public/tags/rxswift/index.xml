<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Rxswift on chooblarin&#39;s blog</title>
    <link>http://chooblarin.github.io/tags/rxswift/index.xml</link>
    <description>Recent content in Rxswift on chooblarin&#39;s blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016 chooblarin</copyright>
    <atom:link href="http://chooblarin.github.io/tags/rxswift/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>RxSwiftã®Schedulersã¨æˆ¯ã‚Œã‚‹</title>
      <link>http://chooblarin.github.io/post/understanding-schedulers/</link>
      <pubDate>Fri, 05 May 2017 13:36:25 +0900</pubDate>
      
      <guid>http://chooblarin.github.io/post/understanding-schedulers/</guid>
      <description>

&lt;p&gt;iOSã®ã‚¢ãƒ—ãƒªé–‹ç™ºã‚’å§‹ã‚ã¦1å¹´ãŒçµŒéã—ã¾ã—ãŸï¼RxSwiftã¨ã®ä»˜ãåˆã„ã‚‚1å¹´ãŒçµŒéã—ã¾ã—ãŸï¼æœ€è¿‘ã¯ä»•äº‹ã§å†ã³Androidã®æ‹…å½“ã«ãªã‚Šã¾ã—ãŸï¼&lt;/p&gt;

&lt;p&gt;ã“ã®è¨˜äº‹ã¯RxSwiftã¨Schedulersã«ã¤ã„ã¦æ›¸ãã¾ã—ãŸï¼GCDã®è©±ã¯å‡ºã¦æ¥ã¾ã›ã‚“ã®ã§çœŸå‰£ã«å‹‰å¼·ã—ãŸæ–¹ã«ã¯ä»¥ä¸‹ã®è§£èª¬ãŒã¨ã¦ã‚‚ç´ æ™´ã‚‰ã—ã„ã§ã™ï¼&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/mixi-inc/iOSTraining/wiki/8.2-Grand-Central-Dispatch&#34;&gt;8.2 Grand Central Dispatch Â· mixi-inc/iOSTraining Wiki&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;observableã¨ã‚¹ãƒ¬ãƒƒãƒ‰&#34;&gt;Observableã¨ã‚¹ãƒ¬ãƒƒãƒ‰&lt;/h2&gt;

&lt;p&gt;Swiftã¯3.1ã§ã™ï¼&lt;/p&gt;

&lt;p&gt;ã¾ãšï¼ŒRxSwiftã§ã¦ãã¨ã†ãªObservableã‚’ä½œã‚Šã¾ã™ï¼&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;let observable = Observable&amp;lt;String&amp;gt;.create { observer -&amp;gt; Disposable in
  observer.onNext(&amp;quot;YO!ğŸ˜&amp;quot;)
  observer.onCompleted()
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;observable.subscribe(onNext: { (message: String) in
  print(message)
})
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;YO!ğŸ˜
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ¬¡ã«ï¼Œ5ç§’å¾Œã«ã€ŒYO!ã€ã‚’å—ã‘å–ã‚‹ã‚ˆã†ã«Observableã‚’å¤‰æ›´ã—ã¾ã™ï¼&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;let observable = Observable&amp;lt;String&amp;gt;.create { observer -&amp;gt; Disposable in
  Thread.sleep(forTimeInterval: 5) // Blocking
  observer.onNext(&amp;quot;YO!ğŸ˜&amp;quot;)
  observer.onCompleted()
  return Disposables.create()
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Observableã®å‡¦ç†ã¯ï¼Œé€šå¸¸ã¯&lt;code&gt;subscribe&lt;/code&gt;ã‚’å‘¼ã³å‡ºã—ãŸã‚¹ãƒ¬ãƒƒãƒ‰ã§å®Ÿè¡Œã•ã‚Œã¾ã™ï¼
ãªã®ã§&lt;code&gt;Thread.sleep&lt;/code&gt;ã¯mainã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¦ã„ã¾ã™ï¼mainã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ã®ã¯ã‚¤ã‚±ãªã„ã“ã¨ãªã®ã§ï¼Œæ˜ç¤ºçš„ã«åˆ¥ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã§å‡¦ç†ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ï¼&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;let observable = Observable&amp;lt;String&amp;gt;.create { observer -&amp;gt; Disposable in

  DispatchQueue.global(qos: .default).async {

    Thread.sleep(forTimeInterval: 5) // ...zzZ

    observer.onNext(&amp;quot;YO!ğŸ˜&amp;quot;)
    observer.onCompleted()
  }
  return Disposables.create()
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã€ŒYO!ã€ãŒã©ã®ã‚¹ãƒ¬ãƒƒãƒ‰ã‹ã‚‰æ¥ã¦ã„ã‚‹ã®ã‹çŸ¥ã‚ŠãŸã„ã®ã§ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã‚’ä½œã£ã¦&lt;code&gt;subscribe&lt;/code&gt;ã™ã‚‹å´ã‚’å°‘ã—å¤‰æ›´ã—ã¾ã™ï¼&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;func which() -&amp;gt; String {
  return Thread.isMainThread ? &amp;quot;main&amp;quot; : &amp;quot;background&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;observable.subscribe(onNext: { (message: String) in
  print(&amp;quot;\(message) on \(which())&amp;quot;)
})
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;YO!ğŸ˜ on background
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‹ã‚‰ã€ŒYO!ã€ãŒå±Šãã¾ã—ãŸï¼&lt;/p&gt;

&lt;p&gt;mainã‚¹ãƒ¬ãƒƒãƒ‰ä»¥å¤–ã‹ã‚‰UIã«è§¦ã‚ã†ã¨ã™ã‚‹ã¨Systemã«æ€’ã‚‰ã‚Œã¦ã—ã¾ã„ã¾ã™ï¼ãªã®ã§åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰ã§çœ ã£ã¦ã‹ã‚‰ã€ŒYO!ã€ã®é€ä¿¡ã ã‘ã‚’mainã‚¹ãƒ¬ãƒƒãƒ‰ã§è¡Œã†ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ï¼&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;let observable = Observable&amp;lt;String&amp;gt;.create { observer -&amp;gt; Disposable in

  DispatchQueue.global(qos: .default).async {

    Thread.sleep(forTimeInterval: 5)

    DispatchQueue.main.async {
      observer.onNext(&amp;quot;YO!ğŸ˜&amp;quot;)
      observer.onCompleted()
    }
  }
  return Disposables.create()
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;YO!ğŸ˜ on main
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã†ã¾ãã„ãã¾ã—ãŸï¼ã“ã‚Œã§ãƒãƒ³ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°YO!YO!ãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸï¼&lt;/p&gt;

&lt;p&gt;ã•ã¦ï¼Œã“ã“ã¾ã§ã®ã€ŒYO!ã€ã‚’æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¾ã™ï¼&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;let observable = Observable&amp;lt;String&amp;gt;.create { observer -&amp;gt; Disposable in

  observer.onNext(&amp;quot;YO!ğŸ˜&amp;quot;) // where subscribe() is called

  DispatchQueue.global(qos: .default).async {

    Thread.sleep(forTimeInterval: 5)
    observer.onNext(&amp;quot;YO!ğŸ˜&amp;quot;) // background

    DispatchQueue.main.async {
      observer.onNext(&amp;quot;YO!ğŸ˜&amp;quot;) // main
      observer.onCompleted()
    }
  }
  return Disposables.create()
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;YO!ğŸ˜ on main
YO!ğŸ˜ on background
YO!ğŸ˜ on main
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã„ã„æ„Ÿã˜ã§ã™ï¼&lt;/p&gt;

&lt;h2 id=&#34;schedulers&#34;&gt;Schedulers&lt;/h2&gt;

&lt;p&gt;æ¬¡ã¯ã„ã‚ˆã„ã‚ˆSchedulerã‚’ä½¿ã„ã¾ã™ï¼Observableã®&lt;code&gt;observeOn&lt;/code&gt;ã«&lt;code&gt;MainScheduler&lt;/code&gt;ã‚’æŒ‡å®šã—ã¾ã™ï¼&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;observable
  .observeOn(MainScheduler.instance)
  .subscribe(onNext: { (message: String) in
    print(&amp;quot;\(message) (Here is \(which()))&amp;quot;)
  })
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;YO!ğŸ˜ (Here is main)
YO!ğŸ˜ (Here is main)
YO!ğŸ˜ (Here is main)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;subscribe&lt;/code&gt;ã®ä¸­ãŒå…¨ã¦mainã‚¹ãƒ¬ãƒƒãƒ‰ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼&lt;code&gt;MainScheduler&lt;/code&gt;ã‚’æŒ‡å®šã—ãŸãŠã‹ã’ã§&lt;code&gt;DispatchQueue.main.async&lt;/code&gt;ã¯ä¸è¦ã«ãªã‚Šã¾ã—ãŸï¼&lt;/p&gt;

&lt;p&gt;ã€ŒYO!ã€ãŒã©ã“ã‹ã‚‰æ¥ã¦ã„ã‚‹ã®ã‹ã‚ã‹ã‚‰ãªããªã£ã¦ã—ã¾ã£ãŸã®ã§å°‘ã—å¤‰æ›´ã‚’åŠ ãˆã¾ã™ï¼&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;let observable = Observable&amp;lt;String&amp;gt;.create { observer -&amp;gt; Disposable in

  observer.onNext(&amp;quot;YO!ğŸ˜ from \(which()).&amp;quot;)

  DispatchQueue.global(qos: .default).async {

    Thread.sleep(forTimeInterval: 5)

    observer.onNext(&amp;quot;YO!ğŸ˜ from \(which()).&amp;quot;)
    observer.onCompleted()
  }
  return Disposables.create()
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;YO!ğŸ˜ from main. (Here is main)
YO!ğŸ˜ from background. (Here is main)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;observeOn&lt;/code&gt;ã®æŒ¯ã‚‹èˆã„ãŒã‚ã‹ã‚Šã¾ã—ãŸï¼&lt;/p&gt;

&lt;p&gt;æ¬¡ã«ï¼Œ&lt;code&gt;subscribeOn&lt;/code&gt;ã§Observableã®å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’æŒ‡å®šã—ã¾ã™ï¼å…ˆã»ã©è¿°ã¹ãŸé€šã‚Šï¼ŒObservableã®å‡¦ç†ã¯ï¼Œé€šå¸¸ã¯&lt;code&gt;subscribe&lt;/code&gt;ã‚’å‘¼ã³å‡ºã—ãŸã‚¹ãƒ¬ãƒƒãƒ‰ã§å®Ÿè¡Œã•ã‚Œã¾ã™ï¼
ã—ã‹ã—&lt;code&gt;subscribeOn&lt;/code&gt;ã‚’ä½¿ã†ã¨ã“ã‚Œã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;observable
  .subscribeOn(ConcurrentDispatchQueueScheduler(qos: .default))
  .observeOn(MainScheduler.instance)
  .subscribe(onNext: { (message: String) in
    print(&amp;quot;\(message) (Here is \(which()))&amp;quot;)
  })
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;YO!ğŸ˜ from background. (Here is main)
YO!ğŸ˜ from background. (Here is main)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã‚¹ãƒªãƒ¼ãƒ—ã®å‡¦ç†ã‚’DispatchQueueã§æŒ‡å®šã™ã‚‹å¿…è¦ãŒç„¡ããªã‚Šã¾ã™ã®ã§ï¼ŒObservableã¯ã“ã†ãªã‚Šã¾ã™ï¼&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;let observable = Observable&amp;lt;String&amp;gt;.create { observer -&amp;gt; Disposable in
  Thread.sleep(forTimeInterval: 5)
  observer.onNext(&amp;quot;YO!ğŸ˜ from \(which()).&amp;quot;)
  observer.onCompleted()
  return Disposables.create()
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã“ã‚Œã¯å†’é ­ã«å‡ºã¦æ¥ãŸObservableã§ã™ï¼Schedulersã‚’åˆ©ç”¨ã™ã‚Œã°ç°¡å˜ã«ãƒãƒ³ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°YO!YO!ãŒå‡ºæ¥ã¾ã™ï¼ä»¥ä¸Šã§ã™ï¼&lt;/p&gt;

&lt;p&gt;ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯&lt;a href=&#34;https://gist.github.com/chooblarin/a041328422870581c616f32717d80393&#34;&gt;Gist&lt;/a&gt; ã«ç½®ã„ã¦ãŠãã¾ã™ï¼&lt;/p&gt;

&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/ReactiveX/RxSwift/blob/master/Documentation/Schedulers.md&#34;&gt;RxSwift/Schedulers.md at master Â· ReactiveX/RxSwift&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://swiftpearls.com/RxSwift-for-dummies-2-Operators.html&#34;&gt;RxSwift For Dummies ğŸ¥ Part 2&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
  </channel>
</rss>