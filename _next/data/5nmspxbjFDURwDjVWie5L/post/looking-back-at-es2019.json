{"pageProps":{"postContent":{"title":"ES2019ã‚’æŒ¯ã‚Šè¿”ã‚‹","date":"2019-11-27T22:32:00+09:00","slug":"looking-back-at-es2019","tags":["JavaScript"],"draft":false,"content":"<p>ä»Šå¹´ã‚‚æ®‹ã™ã¨ã“ã‚ã‚ã¨ä¸€ãƒ¶æœˆã¨ãªã‚Šã¾ã—ãŸã­ã€‚ã“ã®è¨˜äº‹ã§ã¯ ES2019 ã®æ–°æ©Ÿèƒ½ã‚’ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã¨å…±ã«æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¾ã™ã€‚</p>\n<h3><code>Array.prototype.flat</code></h3>\n<p><code>Array.prototype.flat()</code> ã¯å…¥ã‚Œå­ã«ãªã£ãŸé…åˆ—ã®è¦ç´ ã‚’å†å¸°çš„ã«è¾¿ã£ã¦çµåˆã—ãŸé…åˆ—ã‚’æ–°ãŸã«ã¤ãã‚Šã¾ã™ã€‚å¼•æ•°ã«ã¯ï¼Œä½•éšå±¤ã¾ã§è¾¿ã‚‹ã‹ï¼ˆdepthï¼‰æŒ‡å®šã—ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ depth = 1 ã§ã™ã€‚</p>\n<pre><code class=\"hljs language-js\">> <span class=\"hljs-keyword\">const</span> array = [<span class=\"hljs-string\">\"é›¶\"</span>, [<span class=\"hljs-string\">\"å£±\"</span>], [[<span class=\"hljs-string\">\"å¼\"</span>], [[<span class=\"hljs-string\">\"å‚\"</span>]]]];\n> array.flat()\n[<span class=\"hljs-string\">\"é›¶\"</span>, <span class=\"hljs-string\">\"å£±\"</span>, [<span class=\"hljs-string\">\"å¼\"</span>], [[<span class=\"hljs-string\">\"å‚\"</span>]]]\n\n> array.flat(<span class=\"hljs-number\">2</span>)\n[<span class=\"hljs-string\">\"é›¶\"</span>, <span class=\"hljs-string\">\"å£±\"</span>, <span class=\"hljs-string\">\"å¼\"</span>, [<span class=\"hljs-string\">\"å‚\"</span>]]\n\n> array.flat(<span class=\"hljs-number\">3</span>)\n[<span class=\"hljs-string\">\"é›¶\"</span>, <span class=\"hljs-string\">\"å£±\"</span>, <span class=\"hljs-string\">\"å¼\"</span>, <span class=\"hljs-string\">\"å‚\"</span>]\n\n> array.flat(<span class=\"hljs-number\">10</span>) <span class=\"hljs-comment\">// å¤šã‚ã«depthã‚’æŒ‡å®š</span>\n[<span class=\"hljs-string\">\"é›¶\"</span>, <span class=\"hljs-string\">\"å£±\"</span>, <span class=\"hljs-string\">\"å¼\"</span>, <span class=\"hljs-string\">\"å‚\"</span>]\n\n> array.flat(<span class=\"hljs-number\">0</span>) <span class=\"hljs-comment\">// depth = 0 ã¯ä½•ã‚‚å¤‰æ›´ã—ãªã„</span>\n[<span class=\"hljs-string\">\"é›¶\"</span>, [<span class=\"hljs-string\">\"å£±\"</span>], [[<span class=\"hljs-string\">\"å¼\"</span>], [[<span class=\"hljs-string\">\"å‚\"</span>]]]]</code></pre>\n<p><code>.flat()</code> ã¨åŒç­‰ã®åŠ¹æœã‚’å¾—ã‚‹é–¢æ•°ã¯ï¼Œ<code>.reduce()</code> ã¨ <code>.concat()</code> ã¨å†å¸°å‡¦ç†ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ç°¡å˜ã«å®Ÿè£…ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">const</span> flatten = <span class=\"hljs-function\">(<span class=\"hljs-params\">array, depth = <span class=\"hljs-number\">1</span></span>) =></span>\n  array.reduce(\n    <span class=\"hljs-function\">(<span class=\"hljs-params\">acc, val</span>) =></span>\n      acc.concat(\n        depth > <span class=\"hljs-number\">1</span> &#x26;&#x26; <span class=\"hljs-built_in\">Array</span>.isArray(val) ? flatten(val, depth - <span class=\"hljs-number\">1</span>) : val\n      ),\n    []\n  );</code></pre>\n<h3><code>Array.prototype.flatMap</code></h3>\n<p><code>Array.prototype.flatMap()</code> ã¯å‰è¿°ã® <code>.map()</code> ã¨ <code>.flat()</code> ã®çµ„ã¿åˆã‚ã›ã§ã™ã€‚ã™ãªã‚ã¡</p>\n<pre><code class=\"hljs language-js\">array.flatMap(func);</code></pre>\n<p>ã¨</p>\n<pre><code class=\"hljs language-js\">array.map(func).flat(<span class=\"hljs-number\">1</span>);</code></pre>\n<p>ã¯ç­‰ä¾¡ã§ã™ã€‚ã“ã“ã§ <code>func</code> ã¯é–¢æ•°ã§ï¼Œã‚·ã‚°ãƒãƒãƒ£ã¯</p>\n<pre><code class=\"hljs language-js\">(value: T, <span class=\"hljs-attr\">index</span>: number, <span class=\"hljs-attr\">array</span>: T[]) => U | <span class=\"hljs-built_in\">Array</span>&#x3C;U></code></pre>\n<p>ã§ã™ã€‚<code>func</code> ãŒæ’ç­‰é–¢æ•° <code>(x) => x</code> ã®ã¨ãã¯<code>.flat()</code> ã¨ç›¸å½“ã§ã™ã€‚ã™ãªã‚ã¡ï¼Œ<code>array.flatMap(x => x)</code> ã¨ <code>array.flat()</code> ã¯ç­‰ä¾¡ã§ã™ã€‚</p>\n<pre><code class=\"hljs language-js\">> <span class=\"hljs-keyword\">const</span> duplicate = <span class=\"hljs-function\">(<span class=\"hljs-params\">x</span>) =></span> ([x, x])\n\n> duplicate(<span class=\"hljs-string\">\"ğŸ‘½\"</span>)\n[<span class=\"hljs-string\">\"ğŸ‘½\"</span>, <span class=\"hljs-string\">\"ğŸ‘½\"</span>]\n\n> [<span class=\"hljs-string\">\"ğŸ‘½\"</span>, <span class=\"hljs-string\">\"ğŸ‘½\"</span>, <span class=\"hljs-string\">\"ğŸ‘½\"</span>].map(duplicate)\n[[<span class=\"hljs-string\">\"ğŸ‘½\"</span>, <span class=\"hljs-string\">\"ğŸ‘½\"</span>], [<span class=\"hljs-string\">\"ğŸ‘½\"</span>, <span class=\"hljs-string\">\"ğŸ‘½\"</span>], [<span class=\"hljs-string\">\"ğŸ‘½\"</span>, <span class=\"hljs-string\">\"ğŸ‘½\"</span>]]\n\n> [<span class=\"hljs-string\">\"ğŸ‘½\"</span>, <span class=\"hljs-string\">\"ğŸ‘½\"</span>, <span class=\"hljs-string\">\"ğŸ‘½\"</span>].flatMap(duplicate)\n[<span class=\"hljs-string\">\"ğŸ‘½\"</span>, <span class=\"hljs-string\">\"ğŸ‘½\"</span>, <span class=\"hljs-string\">\"ğŸ‘½\"</span>, <span class=\"hljs-string\">\"ğŸ‘½\"</span>, <span class=\"hljs-string\">\"ğŸ‘½\"</span>, <span class=\"hljs-string\">\"ğŸ‘½\"</span>]</code></pre>\n<p>ã¾ãŸï¼Œ<code>.flatMap()</code> ã‚’ä½¿ã†ã¨ï¼Œ<code>.map()</code> ã¨ <code>.filter()</code> ã®åŠ¹æœã‚’åŒæ™‚ã«å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>\n<pre><code class=\"hljs language-js\">> <span class=\"hljs-keyword\">const</span> list = [\n  { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"Batman\"</span> },\n  { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"Jorker\"</span>, <span class=\"hljs-attr\">isVillain</span>: <span class=\"hljs-literal\">true</span> },\n  { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"Gordon\"</span> },\n  { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"Alfred\"</span> },\n  { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"Harvey\"</span> }\n];\n\n> list.flatMap(<span class=\"hljs-function\"><span class=\"hljs-params\">v</span> =></span> v.isVillain ? [] : v.name) <span class=\"hljs-comment\">// ãƒ´ã‚£ãƒ©ãƒ³ä»¥å¤–ã®åå‰ä¸€è¦§ãŒæ¬²ã—ã„</span>\n[<span class=\"hljs-string\">\"Batman\"</span>, <span class=\"hljs-string\">\"Gordon\"</span>, <span class=\"hljs-string\">\"Alfred\"</span>, <span class=\"hljs-string\">\"Harvey\"</span>]</code></pre>\n<h3><code>Object.fromEntries()</code></h3>\n<p><code>Object.fromEntries()</code> ã¯ <code>[key, value]</code> ã®ãƒšã‚¢ã®é…åˆ—ã‹ã‚‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã¤ãã‚Šã¾ã™ã€‚</p>\n<pre><code class=\"hljs language-js\">> <span class=\"hljs-keyword\">const</span> pairs = [[<span class=\"hljs-string\">\"Apple\"</span>, <span class=\"hljs-string\">\"ğŸ\"</span>], [<span class=\"hljs-string\">\"Banana\"</span>, <span class=\"hljs-string\">\"ğŸŒ\"</span>], [<span class=\"hljs-string\">\"Candy\"</span>, <span class=\"hljs-string\">\"ğŸ¬\"</span>]];\n> <span class=\"hljs-built_in\">Object</span>.fromEntries(pairs)\n{ <span class=\"hljs-string\">\"Apple\"</span>: <span class=\"hljs-string\">\"ğŸ\"</span>, <span class=\"hljs-string\">\"Banana\"</span> :<span class=\"hljs-string\">\"ğŸŒ\"</span>, <span class=\"hljs-string\">\"Candy\"</span>: <span class=\"hljs-string\">\"ğŸ¬\"</span> }</code></pre>\n<p><code>key</code> ãŒé‡è¤‡ã—ã¦ã„ãŸå ´åˆï¼Œé…åˆ—ã®å¾Œã‚å´ã®å€¤ã«ãªã‚Šã¾ã™ã€‚</p>\n<pre><code class=\"hljs language-js\">> <span class=\"hljs-built_in\">Object</span>.fromEntries([\n  [<span class=\"hljs-string\">\"Apple\"</span>, <span class=\"hljs-string\">\"ğŸ\"</span>],\n  [<span class=\"hljs-string\">\"Banana\"</span>, <span class=\"hljs-string\">\"ğŸŒ\"</span>],\n  [<span class=\"hljs-string\">\"Candy\"</span>, <span class=\"hljs-string\">\"ğŸ¬\"</span>],\n  [<span class=\"hljs-string\">\"Candy\"</span>, <span class=\"hljs-string\">\"ğŸ­\"</span>],\n  [<span class=\"hljs-string\">\"Apple\"</span>, <span class=\"hljs-string\">\"ğŸ\"</span>]\n])\n{ <span class=\"hljs-string\">\"Apple\"</span>: <span class=\"hljs-string\">\"ğŸ\"</span>, <span class=\"hljs-string\">\"Banana\"</span>: <span class=\"hljs-string\">\"ğŸŒ\"</span>, <span class=\"hljs-string\">\"Candy\"</span>: <span class=\"hljs-string\">\"ğŸ­\"</span> }</code></pre>\n<h3><code>String.prototype.{trimStart,trimEnd}</code></h3>\n<p><code>.trim()</code> ã¯ä¸¡ç«¯ã®ãƒ›ãƒ¯ã‚¤ãƒˆã‚¹ãƒšãƒ¼ã‚¹ã‚’å–ã‚Šé™¤ãã¾ã™ãŒï¼Œ<code>.trimStart()</code> ã¨ <code>.trimEnd()</code> ã¯ãã‚Œãã‚Œï¼Œå§‹ç«¯ï¼Œçµ‚ç«¯ã®ã¿ã«ä½œç”¨ã—ã¾ã™ã€‚</p>\n<pre><code class=\"hljs language-js\">> <span class=\"hljs-string\">\"   (^-^)   \"</span>.trim()\n<span class=\"hljs-string\">\"(^-^)\"</span>\n\n> <span class=\"hljs-string\">\"   (^-^)   \"</span>.trimStart()\n<span class=\"hljs-string\">\"(^-^)   \"</span>\n\n> <span class=\"hljs-string\">\"   (^-^)   \"</span>.trimEnd()\n<span class=\"hljs-string\">\"   (^-^)\"</span></code></pre>\n<h3><code>Symbol.prototype.description</code></h3>\n<p><code>Symbol</code> ã‚’ä½œæˆã™ã‚‹ã¨ãï¼Œãƒ•ã‚¡ã‚¯ãƒˆãƒªé–¢æ•°ã«ä»»æ„ã®æ–‡å­—åˆ—ã‚’æ¸¡ã™ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚</p>\n<pre><code class=\"hljs language-js\">> <span class=\"hljs-keyword\">const</span> symbol = <span class=\"hljs-built_in\">Symbol</span>(<span class=\"hljs-string\">\"ã“ã‚Œã¯ã‚·ãƒ³ãƒœãƒ«ã§ã™\"</span>)\n> <span class=\"hljs-built_in\">String</span>(symbol)\n<span class=\"hljs-string\">\"Symbol(ã“ã‚Œã¯ã‚·ãƒ³ãƒœãƒ«ã§ã™)\"</span></code></pre>\n<p>ã“ã‚Œã¾ã§ï¼Œãã®å€¤ã‚’å–å¾—ã™ã‚‹ã«ã¯ä¸Šè¨˜ã®ã‚ˆã†ã«æ–‡å­—åˆ—ã«å¤‰æ›ã™ã‚‹ã—ã‹ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸãŒï¼Œ <code>description</code> ã¨ã„ã† getter ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>\n<pre><code class=\"hljs language-js\">> symbol.description\n<span class=\"hljs-string\">\"ã“ã‚Œã¯ã‚·ãƒ³ãƒœãƒ«ã§ã™\"</span></code></pre>\n<h3>Optional catch binding</h3>\n<p>ã“ã®ææ¡ˆã«ã‚ˆã‚Šï¼Œä»¥ä¸‹ã®ã‚ˆã†ãªæ›¸ãæ–¹ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">try</span> {\n  valus(); <span class=\"hljs-comment\">// ãƒãƒ«ã‚¹ï¼</span>\n} <span class=\"hljs-keyword\">catch</span> {\n  <span class=\"hljs-comment\">// ä½•ã‹ã™ã‚‹ãŒï¼Œerrorã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ä½¿ã‚ãªãã¦ã„ã„</span>\n}</code></pre>\n<p>ã‚¨ãƒ©ãƒ¼ã‚’æ‰ã¿æ¶ˆã—ãŸã„ã¨ãï¼ˆæ¨å¥¨ã¯ã—ã¾ã›ã‚“ãŒï¼‰ã‚„ï¼Œã©ã‚“ãªã‚¨ãƒ©ãƒ¼ã‚’ã‚­ãƒ£ãƒƒãƒã™ã‚‹ã®ã‹è‡ªæ˜ãªã¨ãã«ä¾¿åˆ©ã«ãªã‚Šã¾ã™ã€‚</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">let</span> result;\n<span class=\"hljs-keyword\">try</span> {\n  result = <span class=\"hljs-built_in\">JSON</span>.parse(str);\n} <span class=\"hljs-keyword\">catch</span> {\n  result = defaultValue;\n}</code></pre>\n<h3>Stable Array.prototype.sort()</h3>\n<p><code>Array.prototype.sort()</code> ã®æŒ™å‹•ãŒå®‰å®šã—ã¾ã—ãŸã€‚</p>\n<pre><code class=\"hljs language-js\">> <span class=\"hljs-keyword\">const</span> prices = [\n  { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"Apple\"</span>, <span class=\"hljs-attr\">price</span>: <span class=\"hljs-number\">150</span> },\n  { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"Banana\"</span>, <span class=\"hljs-attr\">price</span>: <span class=\"hljs-number\">100</span> },\n  { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"Broccoli\"</span>, <span class=\"hljs-attr\">price</span>: <span class=\"hljs-number\">100</span> },\n  { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"Corn\"</span>, <span class=\"hljs-attr\">price</span>: <span class=\"hljs-number\">120</span> }\n];\n> heroes.sort(<span class=\"hljs-function\">(<span class=\"hljs-params\">a, b</span>) =></span> a.price - b.price)\n\n[\n  { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"Banana\"</span>, <span class=\"hljs-attr\">price</span>: <span class=\"hljs-number\">100</span> },\n  { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"Broccoli\"</span>, <span class=\"hljs-attr\">price</span>: <span class=\"hljs-number\">100</span> },\n  { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"Corn\"</span>, <span class=\"hljs-attr\">price</span>: <span class=\"hljs-number\">120</span> },\n  { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"Apple\"</span>, <span class=\"hljs-attr\">price</span>: <span class=\"hljs-number\">150</span> }\n]</code></pre>\n<p>ã“ã®ä¾‹ã§ã¯ï¼Œã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸé…åˆ—ã‚’ä¾¡æ ¼ã§æ˜‡é †ã«ã‚½ãƒ¼ãƒˆã—ãŸä¾‹ã§ã™ã€‚ã“ã‚Œã¾ã§ã¯ï¼ŒåŒã˜ä¾¡æ ¼ã®ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã£ãŸå ´åˆã«ãã®é †ç•ªãŒã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ãªã£ã¦ã„ã‚‹ã“ã¨ãŒä¿è¨¼ã•ã‚Œã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚ã“ã®åº¦ï¼Œ<code>.sort()</code> ã‚’å®Ÿè¡Œã™ã‚‹å‰ã®é †åºãŒä¿å­˜ã•ã‚ŒãŸã¾ã¾ã‚½ãƒ¼ãƒˆã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>\n<h3>ãã®ä»–</h3>\n<p>ãã®ä»–ï¼Œä»¥ä¸‹ã®ã‚ˆã†ãªå¤‰æ›´ãŒã‚ã‚Šã¾ã—ãŸã€‚</p>\n<ul>\n<li>Well-formed JSON.stringify</li>\n<li>JSON superset</li>\n<li>Function.prototype.toString revision</li>\n</ul>\n<h2>å‚è€ƒ</h2>\n<ul>\n<li><a href=\"https://www.youtube.com/watch?v=1_hHxra0Lf4\">ES2019 Features: What Even Are They? by Tara Z. Manicsic | JSConf EU 2019 - YouTube</a></li>\n</ul>\n"}},"__N_SSG":true}