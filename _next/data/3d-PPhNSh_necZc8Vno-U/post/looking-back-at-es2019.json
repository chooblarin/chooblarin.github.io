{"pageProps":{"postContent":{"title":"ES2019ã‚’æŒ¯ã‚Šè¿”ã‚‹","date":"2019-11-27T22:32:00+09:00","slug":"looking-back-at-es2019","tags":["JavaScript"],"draft":false,"content":"<p>ä»Šå¹´ã‚‚æ®‹ã™ã¨ã“ã‚ã‚ã¨ä¸€ãƒ¶æœˆã¨ãªã‚Šã¾ã—ãŸã­ã€‚ã“ã®è¨˜äº‹ã§ã¯ ES2019 ã®æ–°æ©Ÿèƒ½ã‚’ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã¨å…±ã«æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¾ã™ã€‚</p>\n<h3><code>Array.prototype.flat</code></h3>\n<p><code>Array.prototype.flat()</code> ã¯å…¥ã‚Œå­ã«ãªã£ãŸé…åˆ—ã®è¦ç´ ã‚’å†å¸°çš„ã«è¾¿ã£ã¦çµåˆã—ãŸé…åˆ—ã‚’æ–°ãŸã«ã¤ãã‚Šã¾ã™ã€‚å¼•æ•°ã«ã¯ï¼Œä½•éšå±¤ã¾ã§è¾¿ã‚‹ã‹ï¼ˆdepthï¼‰æŒ‡å®šã—ã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ depth = 1 ã§ã™ã€‚</p>\n<pre><code>> <span>const</span> array = [<span>\"é›¶\"</span>, [<span>\"å£±\"</span>], [[<span>\"å¼\"</span>], [[<span>\"å‚\"</span>]]]];\n> array.<span>flat</span>()\n[<span>\"é›¶\"</span>, <span>\"å£±\"</span>, [<span>\"å¼\"</span>], [[<span>\"å‚\"</span>]]]\n\n> array.<span>flat</span>(<span>2</span>)\n[<span>\"é›¶\"</span>, <span>\"å£±\"</span>, <span>\"å¼\"</span>, [<span>\"å‚\"</span>]]\n\n> array.<span>flat</span>(<span>3</span>)\n[<span>\"é›¶\"</span>, <span>\"å£±\"</span>, <span>\"å¼\"</span>, <span>\"å‚\"</span>]\n\n> array.<span>flat</span>(<span>10</span>) <span>// å¤šã‚ã«depthã‚’æŒ‡å®š</span>\n[<span>\"é›¶\"</span>, <span>\"å£±\"</span>, <span>\"å¼\"</span>, <span>\"å‚\"</span>]\n\n> array.<span>flat</span>(<span>0</span>) <span>// depth = 0 ã¯ä½•ã‚‚å¤‰æ›´ã—ãªã„</span>\n[<span>\"é›¶\"</span>, [<span>\"å£±\"</span>], [[<span>\"å¼\"</span>], [[<span>\"å‚\"</span>]]]]</code></pre>\n<p><code>.flat()</code> ã¨åŒç­‰ã®åŠ¹æœã‚’å¾—ã‚‹é–¢æ•°ã¯ï¼Œ<code>.reduce()</code> ã¨ <code>.concat()</code> ã¨å†å¸°å‡¦ç†ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ç°¡å˜ã«å®Ÿè£…ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>\n<pre><code><span>const</span> <span>flatten</span> = (<span>array, depth = <span>1</span></span>) =>\n  array.<span>reduce</span>(\n    <span>(<span>acc, val</span>) =></span>\n      acc.<span>concat</span>(\n        depth > <span>1</span> &#x26;&#x26; <span>Array</span>.<span>isArray</span>(val) ? <span>flatten</span>(val, depth - <span>1</span>) : val\n      ),\n    []\n  );</code></pre>\n<h3><code>Array.prototype.flatMap</code></h3>\n<p><code>Array.prototype.flatMap()</code> ã¯å‰è¿°ã® <code>.map()</code> ã¨ <code>.flat()</code> ã®çµ„ã¿åˆã‚ã›ã§ã™ã€‚ã™ãªã‚ã¡</p>\n<pre><code>array.<span>flatMap</span>(func);</code></pre>\n<p>ã¨</p>\n<pre><code>array.<span>map</span>(func).<span>flat</span>(<span>1</span>);</code></pre>\n<p>ã¯ç­‰ä¾¡ã§ã™ã€‚ã“ã“ã§ <code>func</code> ã¯é–¢æ•°ã§ï¼Œã‚·ã‚°ãƒãƒãƒ£ã¯</p>\n<pre><code>(<span>value</span>: T, <span>index</span>: number, <span>array</span>: T[]) => U | <span>Array</span>&#x3C;U></code></pre>\n<p>ã§ã™ã€‚<code>func</code> ãŒæ’ç­‰é–¢æ•° <code>(x) => x</code> ã®ã¨ãã¯<code>.flat()</code> ã¨ç›¸å½“ã§ã™ã€‚ã™ãªã‚ã¡ï¼Œ<code>array.flatMap(x => x)</code> ã¨ <code>array.flat()</code> ã¯ç­‰ä¾¡ã§ã™ã€‚</p>\n<pre><code>> <span>const</span> <span>duplicate</span> = (<span>x</span>) => ([x, x])\n\n> <span>duplicate</span>(<span>\"ğŸ‘½\"</span>)\n[<span>\"ğŸ‘½\"</span>, <span>\"ğŸ‘½\"</span>]\n\n> [<span>\"ğŸ‘½\"</span>, <span>\"ğŸ‘½\"</span>, <span>\"ğŸ‘½\"</span>].<span>map</span>(duplicate)\n[[<span>\"ğŸ‘½\"</span>, <span>\"ğŸ‘½\"</span>], [<span>\"ğŸ‘½\"</span>, <span>\"ğŸ‘½\"</span>], [<span>\"ğŸ‘½\"</span>, <span>\"ğŸ‘½\"</span>]]\n\n> [<span>\"ğŸ‘½\"</span>, <span>\"ğŸ‘½\"</span>, <span>\"ğŸ‘½\"</span>].<span>flatMap</span>(duplicate)\n[<span>\"ğŸ‘½\"</span>, <span>\"ğŸ‘½\"</span>, <span>\"ğŸ‘½\"</span>, <span>\"ğŸ‘½\"</span>, <span>\"ğŸ‘½\"</span>, <span>\"ğŸ‘½\"</span>]</code></pre>\n<p>ã¾ãŸï¼Œ<code>.flatMap()</code> ã‚’ä½¿ã†ã¨ï¼Œ<code>.map()</code> ã¨ <code>.filter()</code> ã®åŠ¹æœã‚’åŒæ™‚ã«å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>\n<pre><code>> <span>const</span> list = [\n  { <span>name</span>: <span>\"Batman\"</span> },\n  { <span>name</span>: <span>\"Jorker\"</span>, <span>isVillain</span>: <span>true</span> },\n  { <span>name</span>: <span>\"Gordon\"</span> },\n  { <span>name</span>: <span>\"Alfred\"</span> },\n  { <span>name</span>: <span>\"Harvey\"</span> }\n];\n\n> list.<span>flatMap</span>(<span><span>v</span> =></span> v.<span>isVillain</span> ? [] : v.<span>name</span>) <span>// ãƒ´ã‚£ãƒ©ãƒ³ä»¥å¤–ã®åå‰ä¸€è¦§ãŒæ¬²ã—ã„</span>\n[<span>\"Batman\"</span>, <span>\"Gordon\"</span>, <span>\"Alfred\"</span>, <span>\"Harvey\"</span>]</code></pre>\n<h3><code>Object.fromEntries()</code></h3>\n<p><code>Object.fromEntries()</code> ã¯ <code>[key, value]</code> ã®ãƒšã‚¢ã®é…åˆ—ã‹ã‚‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã¤ãã‚Šã¾ã™ã€‚</p>\n<pre><code>> <span>const</span> pairs = [[<span>\"Apple\"</span>, <span>\"ğŸ\"</span>], [<span>\"Banana\"</span>, <span>\"ğŸŒ\"</span>], [<span>\"Candy\"</span>, <span>\"ğŸ¬\"</span>]];\n> <span>Object</span>.<span>fromEntries</span>(<span>pairs</span>)\n{ <span>\"Apple\"</span>: <span>\"ğŸ\"</span>, <span>\"Banana\"</span> :<span>\"ğŸŒ\"</span>, <span>\"Candy\"</span>: <span>\"ğŸ¬\"</span> }</code></pre>\n<p><code>key</code> ãŒé‡è¤‡ã—ã¦ã„ãŸå ´åˆï¼Œé…åˆ—ã®å¾Œã‚å´ã®å€¤ã«ãªã‚Šã¾ã™ã€‚</p>\n<pre><code>> <span>Object</span>.<span>fromEntries</span>(<span>[\n  [<span>\"Apple\"</span>, <span>\"ğŸ\"</span>],\n  [<span>\"Banana\"</span>, <span>\"ğŸŒ\"</span>],\n  [<span>\"Candy\"</span>, <span>\"ğŸ¬\"</span>],\n  [<span>\"Candy\"</span>, <span>\"ğŸ­\"</span>],\n  [<span>\"Apple\"</span>, <span>\"ğŸ\"</span>]\n]</span>)\n{ <span>\"Apple\"</span>: <span>\"ğŸ\"</span>, <span>\"Banana\"</span>: <span>\"ğŸŒ\"</span>, <span>\"Candy\"</span>: <span>\"ğŸ­\"</span> }</code></pre>\n<h3><code>String.prototype.{trimStart,trimEnd}</code></h3>\n<p><code>.trim()</code> ã¯ä¸¡ç«¯ã®ãƒ›ãƒ¯ã‚¤ãƒˆã‚¹ãƒšãƒ¼ã‚¹ã‚’å–ã‚Šé™¤ãã¾ã™ãŒï¼Œ<code>.trimStart()</code> ã¨ <code>.trimEnd()</code> ã¯ãã‚Œãã‚Œï¼Œå§‹ç«¯ï¼Œçµ‚ç«¯ã®ã¿ã«ä½œç”¨ã—ã¾ã™ã€‚</p>\n<pre><code>> <span>\"   (^-^)   \"</span>.<span>trim</span>()\n<span>\"(^-^)\"</span>\n\n> <span>\"   (^-^)   \"</span>.<span>trimStart</span>()\n<span>\"(^-^)   \"</span>\n\n> <span>\"   (^-^)   \"</span>.<span>trimEnd</span>()\n<span>\"   (^-^)\"</span></code></pre>\n<h3><code>Symbol.prototype.description</code></h3>\n<p><code>Symbol</code> ã‚’ä½œæˆã™ã‚‹ã¨ãï¼Œãƒ•ã‚¡ã‚¯ãƒˆãƒªé–¢æ•°ã«ä»»æ„ã®æ–‡å­—åˆ—ã‚’æ¸¡ã™ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚</p>\n<pre><code>> <span>const</span> symbol = <span>Symbol</span>(<span>\"ã“ã‚Œã¯ã‚·ãƒ³ãƒœãƒ«ã§ã™\"</span>)\n> <span>String</span>(symbol)\n<span>\"Symbol(ã“ã‚Œã¯ã‚·ãƒ³ãƒœãƒ«ã§ã™)\"</span></code></pre>\n<p>ã“ã‚Œã¾ã§ï¼Œãã®å€¤ã‚’å–å¾—ã™ã‚‹ã«ã¯ä¸Šè¨˜ã®ã‚ˆã†ã«æ–‡å­—åˆ—ã«å¤‰æ›ã™ã‚‹ã—ã‹ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸãŒï¼Œ <code>description</code> ã¨ã„ã† getter ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>\n<pre><code>> symbol.<span>description</span>\n<span>\"ã“ã‚Œã¯ã‚·ãƒ³ãƒœãƒ«ã§ã™\"</span></code></pre>\n<h3>Optional catch binding</h3>\n<p>ã“ã®ææ¡ˆã«ã‚ˆã‚Šï¼Œä»¥ä¸‹ã®ã‚ˆã†ãªæ›¸ãæ–¹ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>\n<pre><code><span>try</span> {\n  <span>valus</span>(); <span>// ãƒãƒ«ã‚¹ï¼</span>\n} <span>catch</span> {\n  <span>// ä½•ã‹ã™ã‚‹ãŒï¼Œerrorã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ä½¿ã‚ãªãã¦ã„ã„</span>\n}</code></pre>\n<p>ã‚¨ãƒ©ãƒ¼ã‚’æ‰ã¿æ¶ˆã—ãŸã„ã¨ãï¼ˆæ¨å¥¨ã¯ã—ã¾ã›ã‚“ãŒï¼‰ã‚„ï¼Œã©ã‚“ãªã‚¨ãƒ©ãƒ¼ã‚’ã‚­ãƒ£ãƒƒãƒã™ã‚‹ã®ã‹è‡ªæ˜ãªã¨ãã«ä¾¿åˆ©ã«ãªã‚Šã¾ã™ã€‚</p>\n<pre><code><span>let</span> result;\n<span>try</span> {\n  result = <span>JSON</span>.<span>parse</span>(str);\n} <span>catch</span> {\n  result = defaultValue;\n}</code></pre>\n<h3>Stable Array.prototype.sort()</h3>\n<p><code>Array.prototype.sort()</code> ã®æŒ™å‹•ãŒå®‰å®šã—ã¾ã—ãŸã€‚</p>\n<pre><code>> <span>const</span> prices = [\n  { <span>name</span>: <span>\"Apple\"</span>, <span>price</span>: <span>150</span> },\n  { <span>name</span>: <span>\"Banana\"</span>, <span>price</span>: <span>100</span> },\n  { <span>name</span>: <span>\"Broccoli\"</span>, <span>price</span>: <span>100</span> },\n  { <span>name</span>: <span>\"Corn\"</span>, <span>price</span>: <span>120</span> }\n];\n> heroes.<span>sort</span>(<span>(<span>a, b</span>) =></span> a.<span>price</span> - b.<span>price</span>)\n\n[\n  { <span>name</span>: <span>\"Banana\"</span>, <span>price</span>: <span>100</span> },\n  { <span>name</span>: <span>\"Broccoli\"</span>, <span>price</span>: <span>100</span> },\n  { <span>name</span>: <span>\"Corn\"</span>, <span>price</span>: <span>120</span> },\n  { <span>name</span>: <span>\"Apple\"</span>, <span>price</span>: <span>150</span> }\n]</code></pre>\n<p>ã“ã®ä¾‹ã§ã¯ï¼Œã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸé…åˆ—ã‚’ä¾¡æ ¼ã§æ˜‡é †ã«ã‚½ãƒ¼ãƒˆã—ãŸä¾‹ã§ã™ã€‚ã“ã‚Œã¾ã§ã¯ï¼ŒåŒã˜ä¾¡æ ¼ã®ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã£ãŸå ´åˆã«ãã®é †ç•ªãŒã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ãªã£ã¦ã„ã‚‹ã“ã¨ãŒä¿è¨¼ã•ã‚Œã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚ã“ã®åº¦ï¼Œ<code>.sort()</code> ã‚’å®Ÿè¡Œã™ã‚‹å‰ã®é †åºãŒä¿å­˜ã•ã‚ŒãŸã¾ã¾ã‚½ãƒ¼ãƒˆã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>\n<h3>ãã®ä»–</h3>\n<p>ãã®ä»–ï¼Œä»¥ä¸‹ã®ã‚ˆã†ãªå¤‰æ›´ãŒã‚ã‚Šã¾ã—ãŸã€‚</p>\n<ul>\n<li>Well-formed JSON.stringify</li>\n<li>JSON superset</li>\n<li>Function.prototype.toString revision</li>\n</ul>\n<h2>å‚è€ƒ</h2>\n<ul>\n<li><a href=\"https://www.youtube.com/watch?v=1_hHxra0Lf4\">ES2019 Features: What Even Are They? by Tara Z. Manicsic | JSConf EU 2019 - YouTube</a></li>\n</ul>\n"}},"__N_SSG":true}