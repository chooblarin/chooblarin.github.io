---
date: "2022-12-02T00:00:00+00:00"
title: "手軽にウェブサイトのアクセスを制限したい場合のサービス比較"
draft: true
slug: "private-site-hosting-service-comparison"
tags: ["Blog"]
---

この記事は[フラー株式会社 Advent Calendar 2022](https://qiita.com/advent-calendar/2022/fuller-inc) の2日目の記事です。

本記事ではWebページを限られた人にのみがアクセスできるようにしたい場合，ホスティングサービスとフレームワークの選択肢について見ていきます。

## お金をあまり掛けずにBasic認証を追加する
HTTPの認証において最もお手軽な方法として，Basic認証が選択肢として考えられます。

### Vercel + Next.jsでBasic認証

最も簡単にBasic認証を追加できるのは，VercelとNext.jsの組み合わせでした。Vercelが公式のテンプレートを公開しているので，こちらを利用するのと更に簡単です。

<https://vercel.com/templates/next.js/basic-auth-password>

Next.jsの[Middleware](https://nextjs.org/docs/advanced-features/middleware)という機能により，リクエストをインターセプトしたりレスポンスを書き換えたりすることが可能になります。Vercelにデプロイする場合，Edge Functionsと統合して実行できます。本記事執筆時点では無料のHobbyプランで十分に利用できます [*](https://vercel.com/pricing)。


### FirebaseでBasic認証

Firebase HostingとCloud Functionsを組み合わせて利用する方法もあります。Firebase Hostingの[rewrites](https://firebase.google.com/docs/hosting/full-config#rewrites)設定を変更することで，リクエストをCloud Functionsで処理することができます（Cloud FunctionsではなくCloud Runを利用することもできます）。
Cloud Functionsでは[Express.js](https://expressjs.com/)などのフレームワークを利用することもできるので，Expressのmiddlewareとして作られているBasic認証ライブラリを活用することができます。

ググるとたくさんの記事が見つかるため，詳しい実装方法については割愛します。Firebaseにはかなり太っ腹な無料枠があるので，ちょっとした個人利用の場合は無料で利用できると思います。

### CloudflareでBasic認証

Cloudflare Workersの公式ドキュメントにBasic認証の例があります。

<https://developers.cloudflare.com/workers/examples/basic-auth/>

ただし，Next.jsやAstroなどを利用している場合，Cloudflare Pagesにデプロイする方が簡単で便利です。しかもCloudflare Pagesは"Cloudflare Access" というサービスが統合されており，IPアドレス制限やEメールアドレス認証など、Basic認証より遥に高度なアクセス管理が実現できてしまいます。

## NetlifyのBasic認証は有料

Netlifyには"[Custom headers](https://docs.netlify.com/routing/headers/)"という機能があります。これを利用してBasic認証がかけられる…かと思いきや，無料のStarterプランではBasic認証のためのヘッダを設定しても無視されてしまいます。Basic認証を使用するにはStarterプラン以外の有料プランである必要があるようです。

Basic認証の設定方法
<https://docs.netlify.com/visitor-access/password-protection/#selective-protection-with-basic-authentication>


ちなみに，有料プランでは"[Password protection](https://docs.netlify.com/visitor-access/password-protection/)"という機能も利用できて、パスワードを共有する任意の人間に対してサイトの閲覧を許可することができます。

## その他おまけ
### AWS Amplify
今回あまり調べていない

https://aws.amazon.com/jp/amplify/pricing/

### GitHub Pages
GitHub Pagesはお手軽にWebページを公開できますが，GitHubのEnterprise CloudプランであればGitHub Pagesのアクセスをリポジトリのアクセス権限と同様に制限することができます。

https://docs.github.com/en/enterprise-cloud@latest/pages/getting-started-with-github-pages/changing-the-visibility-of-your-github-pages-site