<!DOCTYPE html><html><head><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-62520326-2"></script><script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-62520326-2', {
              page_path: window.location.pathname,
              anonymize_ip: true
            });
          </script><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta name="description" content="Sympathy driven development"/><meta property="og:url" content="https://chooblarin.github.io"/><meta property="og:type" content="website"/><meta property="og:description" content="Sympathy driven development"/><meta property="og:image" content="og-default.png"/><meta property="og:image:alt" content="chooblarin&#x27;s blog"/><meta property="og:image:width" content="1280"/><meta property="og:image:height" content="675"/><meta property="og:site_name" content="chooblarin&#x27;s blog"/><meta name="google-site-verification" content="5MMy9toPN2P8O6xmRyiBp-l97-pCGSnLGS2AwiUdWpI"/><title>2019å¹´ã®Promise | chooblarin&#x27;s blog</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta property="og:title" content="2019å¹´ã®Promise"/><script async="" src="https://platform.twitter.com/widgets.js" charSet="utf-8"></script><script async="" src="https://static.codepen.io/assets/embed/ei.js" charSet="utf-8"></script><script async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" charSet="utf-8"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$']],
    displayMath: [['$$','$$']],
    extensions: ["[Contrib]/a11y/accessibility-menu.js"],
    menuSettings: {
      collapsible: true,
      autocollapse: true,
      explorer: true
    },
    processEscapes: true
  },
  CommonHTML: { matchFontHeight: false },
  displayAlign: "left",
  displayIndent: "2em"
});
</script><link rel="preload" href="/_next/static/css/517dfd780b4684c2b21d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/517dfd780b4684c2b21d.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b0913d6b4f1bdb4d70a1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b0913d6b4f1bdb4d70a1.css" data-n-p=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/_next/static/chunks/main-e57adab046a48d87f0b6.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.1cc9dd07c455eb544511.js" as="script"/><link rel="preload" href="/_next/static/chunks/f1c7a11d82ab5aeae255133ab9a9dd72095cfbe8.ace57a9ae52ca0c4aaff.js" as="script"/><link rel="preload" href="/_next/static/chunks/be0ee40335aab5b90e46c407218b7ebff3be96c3.f5754105fd8cc37bf292.js" as="script"/><link rel="preload" href="/_next/static/chunks/af34e2db61f97cedc6ebfbaa0d751a83f9f0d9f6.585b1c552b574c6100a9.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-c63aeeb3735b54a66118.js" as="script"/><link rel="preload" href="/_next/static/chunks/305bf1217467fbfb8d27f2d195337c27f206dc2e.181a12ddc8dc3a759259.js" as="script"/><link rel="preload" href="/_next/static/chunks/dc565b348471f1cc9a369b64c164a9c4498f98d4.5a431597bfee0da91e6a.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/post/%5Bslug%5D-bc4663299dd8234d2279.js" as="script"/></head><body><div id="__next"><div class="css-0"><style data-emotion-css="cgvvxm">.css-cgvvxm{color:4a4a4a;padding:12px 8px 20px;}</style><header class="css-cgvvxm"><style data-emotion-css="dvxtzn">.css-dvxtzn{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><section class="css-dvxtzn"><style data-emotion-css="4g6ai3">.css-4g6ai3{cursor:pointer;}</style><a class="css-4g6ai3"><style data-emotion-css="jbzcs3">.css-jbzcs3{width:207px;padding:10px 0 20px;}</style><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 207 68" class="css-jbzcs3"><title>chooblarinâ€™s blog</title><g transform="translate(-57, -32)" fill="#777777"><path d="M70.1,42.2 L60.5,42.2 L60.5,39 L70.1,39 L70.1,42.2 Z M60.5,51.8 L57.3,51.8 L57.3,42.2 L60.5,42.2 L60.5,51.8 Z M70.1,55 L60.5,55 L60.5,51.8 L70.1,51.8 L70.1,55 Z M79.7,42.2 L82.9,42.2 L82.9,45.4 L79.7,45.4 L79.7,55 L76.5,55 L76.5,32.6 L79.7,32.6 L79.7,42.2 Z M89.3,42.2 L82.9,42.2 L82.9,39 L89.3,39 L89.3,42.2 Z M92.5,55 L89.3,55 L89.3,42.2 L92.5,42.2 L92.5,55 Z M111.7,42.2 L102.1,42.2 L102.1,39 L111.7,39 L111.7,42.2 Z M102.1,51.8 L98.9,51.8 L98.9,42.2 L102.1,42.2 L102.1,51.8 Z M114.9,51.8 L111.7,51.8 L111.7,42.2 L114.9,42.2 L114.9,51.8 Z M111.7,55 L102.1,55 L102.1,51.8 L111.7,51.8 L111.7,55 Z M134.1,42.2 L124.5,42.2 L124.5,39 L134.1,39 L134.1,42.2 Z M124.5,51.8 L121.3,51.8 L121.3,42.2 L124.5,42.2 L124.5,51.8 Z M137.3,51.8 L134.1,51.8 L134.1,42.2 L137.3,42.2 L137.3,51.8 Z M134.1,55 L124.5,55 L124.5,51.8 L134.1,51.8 L134.1,55 Z M146.9,39 L156.5,39 L156.5,42.2 L146.9,42.2 L146.9,51.8 L156.5,51.8 L156.5,55 L143.7,55 L143.7,32.6 L146.9,32.6 L146.9,39 Z M159.7,51.8 L156.5,51.8 L156.5,42.2 L159.7,42.2 L159.7,51.8 Z M169.3,51.8 L166.1,51.8 L166.1,32.6 L169.3,32.6 L169.3,51.8 Z M172.5,55 L169.3,55 L169.3,51.8 L172.5,51.8 L172.5,55 Z M188.5,42.2 L178.9,42.2 L178.9,39 L188.5,39 L188.5,42.2 Z M191.7,55 L178.9,55 L178.9,51.8 L188.5,51.8 L188.5,48.6 L178.9,48.6 L178.9,45.4 L188.5,45.4 L188.5,42.2 L191.7,42.2 L191.7,55 Z M178.9,51.8 L175.7,51.8 L175.7,48.6 L178.9,48.6 L178.9,51.8 Z M201.3,42.2 L204.5,42.2 L204.5,45.4 L201.3,45.4 L201.3,55 L198.1,55 L198.1,39 L201.3,39 L201.3,42.2 Z M210.9,42.2 L204.5,42.2 L204.5,39 L210.9,39 L210.9,42.2 Z M218.9,35.8 L215.7,35.8 L215.7,32.6 L218.9,32.6 L218.9,35.8 Z M218.9,55 L215.7,55 L215.7,39 L218.9,39 L218.9,55 Z M238.1,42.2 L228.5,42.2 L228.5,39 L238.1,39 L238.1,42.2 Z M228.5,55 L225.3,55 L225.3,42.2 L228.5,42.2 L228.5,55 Z M241.3,55 L238.1,55 L238.1,42.2 L241.3,42.2 L241.3,55 Z M247.7,39 L244.5,39 L244.5,32.6 L247.7,32.6 L247.7,39 Z M263.7,42.2 L254.1,42.2 L254.1,39 L263.7,39 L263.7,42.2 Z M254.1,45.4 L250.9,45.4 L250.9,42.2 L254.1,42.2 L254.1,45.4 Z M260.5,48.6 L254.1,48.6 L254.1,45.4 L260.5,45.4 L260.5,48.6 Z M263.7,51.8 L260.5,51.8 L260.5,48.6 L263.7,48.6 L263.7,51.8 Z M260.5,55 L250.9,55 L250.9,51.8 L260.5,51.8 L260.5,55 Z M127.7,77 L137.3,77 L137.3,80.2 L127.7,80.2 L127.7,89.8 L137.3,89.8 L137.3,93 L124.5,93 L124.5,70.6 L127.7,70.6 L127.7,77 Z M140.5,89.8 L137.3,89.8 L137.3,80.2 L140.5,80.2 L140.5,89.8 Z M150.1,89.8 L146.9,89.8 L146.9,70.6 L150.1,70.6 L150.1,89.8 Z M153.3,93 L150.1,93 L150.1,89.8 L153.3,89.8 L153.3,93 Z M170.9,80.2 L161.3,80.2 L161.3,77 L170.9,77 L170.9,80.2 Z M161.3,89.8 L158.1,89.8 L158.1,80.2 L161.3,80.2 L161.3,89.8 Z M174.1,89.8 L170.9,89.8 L170.9,80.2 L174.1,80.2 L174.1,89.8 Z M170.9,93 L161.3,93 L161.3,89.8 L170.9,89.8 L170.9,93 Z M193.3,80.2 L183.7,80.2 L183.7,77 L193.3,77 L193.3,80.2 Z M183.7,89.8 L180.5,89.8 L180.5,80.2 L183.7,80.2 L183.7,89.8 Z M196.5,96.2 L193.3,96.2 L193.3,93 L183.7,93 L183.7,89.8 L193.3,89.8 L193.3,80.2 L196.5,80.2 L196.5,96.2 Z M193.3,99.4 L183.7,99.4 L183.7,96.2 L193.3,96.2 L193.3,99.4 Z"></path></g></svg></a><style data-emotion-css="1dkevec">.css-1dkevec{width:64px;height:64px;color:#4a4a4a;margin-bottom:20px;}</style><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="css-1dkevec"><g stroke="currentColor" stroke-width="8"><path fill="currentColor" d="M88 236 A54 64 0 0 0 196 236Z M316 236 A54 64 0 0,0 424 236Z"></path><path fill="none" d="M68 335 H444 M77 335 A196 208 0 0 0 435 335 M117 376 H396 M146 350 V402 M200 350 V430 M256 350 V436 M312 350 V430 M366 350 V402 M16 256 A240 240 0 1 0 496 256 A240 240 0 1 0 16 256"></path></g></svg><style data-emotion-css="1hushib">.css-1hushib{display:grid;grid-auto-flow:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;color:#777777;}.css-1hushib a{padding:8px;}</style><div class="css-1hushib"><a href="https://twitter.com/chooblarin" target="_blank" rel="noopener noreferrer"><style data-emotion-css="e8zxav">.css-e8zxav{width:24px;height:24px;color:#4a4a4a;}.css-e8zxav:hover{color:#983bc9;}</style><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="css-e8zxav"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a><a href="https://github.com/chooblarin" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="css-e8zxav"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a href="https://linkedin.com/in/sota-hatakeyama-35bb07120" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="css-e8zxav"><path fill="currentColor" d="M100.3 448H7.4V148.9h92.9V448zM53.8 108.1C24.1 108.1 0 83.5 0 53.8S24.1 0 53.8 0s53.8 24.1 53.8 53.8-24.1 54.3-53.8 54.3zM448 448h-92.7V302.4c0-34.7-.7-79.2-48.3-79.2-48.3 0-55.7 37.7-55.7 76.7V448h-92.8V148.9h89.1v40.8h1.3c12.4-23.5 42.7-48.3 87.9-48.3 94 0 111.3 61.9 111.3 142.3V448h-.1z"></path></svg></a><a href="mailto:choo.bla.rin@gmail.com"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="css-e8zxav"><path fill="currentColor" d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 400V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V400H48z"></path></svg></a></div></section></header><style data-emotion-css="k7lbbj">.css-k7lbbj{max-width:740px;line-height:1.5;margin:0 auto;padding:0 20px 100px;}.css-k7lbbj code{background:#e7e7ea;border-radius:4px;padding:2px 6px;font-weight:600;}.css-k7lbbj pre > code{padding:0.8rem;background:#011627;border:2px solid #aaa;font-weight:500;}.css-k7lbbj h1,.css-k7lbbj h2,.css-k7lbbj h3,.css-k7lbbj h4,.css-k7lbbj h5,.css-k7lbbj h6{font-weight:600;line-height:1;color:#676767;margin:2rem 0 1rem;padding-top:0.875rem;}.css-k7lbbj h1{font-size:2.25rem;}.css-k7lbbj h2{font-size:1.85rem;}.css-k7lbbj h3{font-size:1.55rem;}.css-k7lbbj h4{font-size:1.25rem;}.css-k7lbbj h5{font-size:1rem;}.css-k7lbbj h6{font-size:0.875rem;}.css-k7lbbj p{margin:1.5rem 0;}.css-k7lbbj li::marker{color:#676767;}</style><main class="css-k7lbbj"><h1>2019å¹´ã®Promise</h1><style data-emotion-css="1nilrd9">.css-1nilrd9{font-size:14px;color:#767676;}</style><p class="css-1nilrd9">December 01, 2019</p><style data-emotion-css="1uwgdjb">.css-1uwgdjb{list-style:none;margin:0 0 72px;}.css-1uwgdjb ul{margin:0;padding:0;}.css-1uwgdjb li{display:inline-block;margin:8px 8px 8px 0;}</style><div class="css-1uwgdjb"><ul><li><style data-emotion-css="putjag">.css-putjag{color:#6b6b6b;background:#eeeeee;font-size:12px;padding:7px 12px;border-radius:2px;}</style><a href="/tags/javascript" class="css-putjag">#JavaScript</a></li></ul></div><div><p>ã“ã®è¨˜äº‹ã¯<a href="https://adventar.org/calendars/4155">ãƒ•ãƒ©ãƒ¼ Advent Calendar 2019</a>ã® 1 æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚</p>
<p>ä»Šå¹´ã‚‚ JavaScript (TypeSctipt) ã‚’ãŸãã•ã‚“æ›¸ãã¾ã—ãŸã€‚</p>
<p>JavaScript ã«ã¯ ECMAScript ã¨ã„ã†æ¨™æº–ä»•æ§˜ãŒã‚ã‚Šã¾ã™ãŒï¼Œè¿‘å¹´ã§ã¯ TC39 ã«ã‚ˆã£ã¦æ¯å¹´æ–°ã—ã„æ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ã€‚è­°è«–ã®ãƒ—ãƒ­ã‚»ã‚¹ã¯å¸¸ã«ã‚ªãƒ¼ãƒ—ãƒ³ã«ãªã£ã¦ã„ã‚‹ã®ã§èª°ã§ã‚‚é–²è¦§ã§ãã¾ã™ <a href="https://github.com/tc39">*</a>ã€‚</p>
<p>ãã—ã¦ä»Šå›ã¯ JavaScript ã®"Promise"ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ã¦è¿‘æ³ã‚’è§£èª¬ã—ã¾ã™ã€‚</p>
<h2>Promise ã§éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°</h2>
<p>Promise ã¯ ES2015 (ES6)ã§æ­£å¼ã«å°å…¥ã•ã‚Œã¾ã—ãŸãŒï¼Œãã‚Œä»¥å‰ã«ã‚‚ JavaScript ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®éåŒæœŸå‡¦ç†ã®ä¸­å¿ƒã«ã„ã¾ã—ãŸã€‚</p>
<p>ã¾ãšã¯ Promise ã«ã¤ã„ã¦ç°¡å˜ã«å¾©ç¿’ã—ã¾ã—ã‚‡ã†ã€‚ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ Promise ã‚’ç”Ÿæˆã™ã‚‹ä¸€èˆ¬çš„ãªå½¢å¼ã®ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> {
  doSomething(<span class="hljs-function"><span class="hljs-params">x</span> =></span> {
    <span class="hljs-keyword">if</span> (x) {
      <span class="hljs-comment">// æˆåŠŸ</span>
      resolve(x);
    } <span class="hljs-keyword">else</span> {
      reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"å¤±æ•—ğŸ˜¢"</span>));
    }
  });
});


promise
  .then(<span class="hljs-function"><span class="hljs-params">result</span> =></span> { ... })
  .catch(<span class="hljs-function"><span class="hljs-params">error</span> =></span> { ... });</code></pre>
<p><code>doSomething</code> ã¯ä½•ã‚‰ã‹ã®éåŒæœŸå‡¦ç†ã‚’è¡Œã„ï¼Œã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã«ã‚ˆã£ã¦çµæœã‚’å¾—ã‚‹é–¢æ•°ã§ã™ã€‚ç„¡äº‹ã«çµæœãŒå¾—ã‚‰ã‚ŒãŸã¨ãã¯ <code>resolve()</code> ã‚’ä½¿ã„ã¾ã™ã€‚ã‚‚ã—ã‚‚çµæœãŒå¾—ã‚‰ã‚Œãªã‹ã£ãŸã¨ãã¯ <code>reject()</code>ã‚’ä½¿ã„ã¾ã™ã€‚</p>
<p>Promise ã«ã¯"pending", "fulfilled", "rejected" ã® 3 ã¤ã®çŠ¶æ…‹ãŒå­˜åœ¨ã—ã¾ã™ã€‚å…ˆã»ã©ã®ä¾‹ã§ï¼Œ<code>resolve()</code> ã‹ <code>reject()</code> ã‚’å‘¼ã³ã ã™å‰ã®çŠ¶æ…‹ã¯ <strong>pending</strong> çŠ¶æ…‹ã§ã™ã€‚å‘¼ã³å‡ºã—ãŸã‚ã¨ã¯ <strong>fulfilled</strong> ã‹ <strong>rejected</strong> ã®ã„ãšã‚Œã‹ã®çŠ¶æ…‹ã«ãªã‚Šã¾ã™ï¼ˆã“ã‚Œã‚’ <strong>Settled</strong> ã¨å‘¼ã³ã¾ã™ï¼‰ã€‚</p>
<img src="https://user-images.githubusercontent.com/3143302/69895358-261eb400-1371-11ea-9a11-7c88b1a6226d.png" alt="promise has 3 states" style="display:block;margin:0 auto;width:95%;max-width:320px;">
<p>Promise ã¯å¿…ãš 3 ã¤ã®ã†ã¡ã„ãšã‚Œã‹çŠ¶æ…‹ã‚’ã¨ã‚Šã¾ã™ãŒï¼ŒSettled ã«ãªã‚‰ãªã„å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ï¼Œä»¥ä¸‹ã® Promise ã¯æ°¸ä¹…ã« pending çŠ¶æ…‹ã§ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">() =></span> {});</code></pre>
<h2><code>.finally()</code></h2>
<p>ES2018 ã§ã¯ <code>Promise.prototype.finally()</code> ãŒå°å…¥ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
<pre><code class="hljs language-js">promise
  .then(<span class="hljs-function"><span class="hljs-params">result</span> =></span> { ... })
  .catch(<span class="hljs-function"><span class="hljs-params">error</span> =></span> { ... })
  .finally(<span class="hljs-function">() =></span> {
    <span class="hljs-comment">// å¾Œå§‹æœ«ã‚’ã“ã“ã«æ›¸ã</span>
  });</code></pre>
<p><code>.finally()</code>ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã¯ï¼Œfulfilled ã‹ rejected ã‹ã«é–¢ã‚ã‚‰ãšå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚</p>
<h2>è¤‡æ•°ã® Promise ã‚’æ“ã‚‹ <code>Promise.all</code> ã¨ <code>Promise.race</code></h2>
<p>ES2015 ã§ã¯ï¼Œ è¤‡æ•°ã® Promise ã‚’æ“ä½œã™ã‚‹ API <code>Promise.all</code> ã¨ <code>Promise.race</code> ã® 2 ã¤ãŒå°å…¥ã•ã‚Œã¾ã—ãŸã€‚</p>
<ul>
<li><code>Promise.all</code>ï¼šå…¨ã¦ã® Promise ãŒ fulfilled ã¨ãªã£ãŸçµæœ</li>
<li><code>Promise.race</code>ï¼šã„ãšã‚Œã‹ã® Promise ã®ã†ã¡æœ€åˆã« Settled ã¨ãªã£ãŸçµæœ</li>
</ul>
<p><code>Promise.all</code> ã¯è¤‡æ•°ã®éåŒæœŸå‡¦ç†ã‚’åŒæ™‚ã«ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¦ï¼Œå…¨ã¦ãŒå®Œäº†ã—ãŸãã®çµæœã‚’æ‰±ã„ãŸã„ã¨ãã«ä½¿ã„ã¾ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =></span> resolve(<span class="hljs-string">"æˆåŠŸğŸ˜„"</span>), <span class="hljs-number">100</span>);
});

<span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =></span> resolve(<span class="hljs-string">"æˆåŠŸğŸ˜"</span>), <span class="hljs-number">200</span>);
});

<span class="hljs-keyword">const</span> p3 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =></span> resolve(<span class="hljs-string">"æˆåŠŸğŸ˜"</span>), <span class="hljs-number">300</span>);
});

<span class="hljs-built_in">Promise</span>.all([p1, p2, p3])
  .then(<span class="hljs-function"><span class="hljs-params">result</span> =></span> <span class="hljs-built_in">console</span>.log(result)) <span class="hljs-comment">// ["æˆåŠŸğŸ˜„", "æˆåŠŸğŸ˜", "æˆåŠŸğŸ˜"]</span>
  .catch(<span class="hljs-function"><span class="hljs-params">e</span> =></span> <span class="hljs-built_in">console</span>.log(e.message));</code></pre>
<h2><code>Promise.allSettled</code> ã¨ <code>Promise.any</code></h2>
<p><code>Promise.all</code> ã¯ï¼ŒPromise ãŒ 1 ã¤ã§ã‚‚å¤±æ•—ã—ã¦ <code>rejected</code> ã«ãªã£ãŸã‚‰ï¼Œãã®çµæœã¯ <code>rejected</code> ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =></span> resolve(<span class="hljs-string">"æˆåŠŸğŸ˜„"</span>), <span class="hljs-number">100</span>);
});

<span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =></span> resolve(<span class="hljs-string">"æˆåŠŸğŸ˜"</span>), <span class="hljs-number">200</span>);
});

<span class="hljs-keyword">const</span> p3 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =></span> reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"å¤±æ•—ğŸ˜­"</span>)), <span class="hljs-number">300</span>);
});

<span class="hljs-built_in">Promise</span>.all([p1, p2, p3])
  .then(<span class="hljs-function"><span class="hljs-params">result</span> =></span> <span class="hljs-built_in">console</span>.log(result))
  .catch(<span class="hljs-function"><span class="hljs-params">e</span> =></span> <span class="hljs-built_in">console</span>.log(e.message)); <span class="hljs-comment">// "å¤±æ•—ğŸ˜­"</span></code></pre>
<p>ãã“ã§æ–°ãŸã« 2 ã¤ã® API ãŒææ¡ˆã•ã‚Œï¼Œå°å…¥ã•ã‚Œã‚ˆã†ã¨ã—ã¦ã„ã¾ã™ã€‚</p>
<ul>
<li><code>Promise.allSettled</code>ï¼šå…¨ã¦ã® Promise ãŒ Settled ã¨ãªã£ãŸçµæœ</li>
<li><code>Promise.any</code>ï¼šã„ãšã‚Œã‹ã® Promise ãŒæœ€åˆã« fulfilled ã¨ãªã£ãŸçµæœã€‚å…¨ã¦ã® Promise ãŒ rejected ã®å ´åˆã«ã®ã¿ï¼Œrejected çŠ¶æ…‹ã«ãªã‚‹ã€‚</li>
</ul>
<p>å…ˆã»ã©ã®ä¾‹ã‚’ <code>Promise.allSettled</code> ã‚’ä½¿ã£ã¦æ›¸ãã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> p1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =></span> resolve(<span class="hljs-string">"æˆåŠŸğŸ˜„"</span>), <span class="hljs-number">100</span>);
});

<span class="hljs-keyword">const</span> p2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =></span> resolve(<span class="hljs-string">"æˆåŠŸğŸ˜"</span>), <span class="hljs-number">200</span>);
});

<span class="hljs-keyword">const</span> p3 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =></span> {
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =></span> reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"å¤±æ•—ğŸ˜­"</span>)), <span class="hljs-number">300</span>);
});

<span class="hljs-built_in">Promise</span>.allSettled([p1, p2, p3])
  .then(<span class="hljs-function"><span class="hljs-params">result</span> =></span> <span class="hljs-built_in">console</span>.log(result.map(<span class="hljs-function"><span class="hljs-params">r</span> =></span> r.value))) <span class="hljs-comment">// ["æˆåŠŸğŸ˜„", "æˆåŠŸğŸ˜", undefined]</span>
  .catch(<span class="hljs-function"><span class="hljs-params">e</span> =></span> <span class="hljs-built_in">console</span>.log(e.message));</code></pre>
<h2><code>async</code> / <code>await</code></h2>
<p>ES2017 ã§è¿½åŠ ã•ã‚ŒãŸ Async é–¢æ•°ã‚’ä½¿ã†ã¨ï¼ŒPromise ã‚’æ›´ã«æ‰±ã„ã‚„ã™ããªã‚Šã¾ã™ã€‚Async é–¢æ•°ã¯ä»¥ä¸‹ã®ã‚ˆã†ã« <code>async</code> ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒã¤ã„ãŸé–¢æ•°ã§ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makePizza</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> ingredients = <span class="hljs-keyword">await</span> prepareIngredients(); <span class="hljs-comment">// ææ–™ã‚’ç”¨æ„ã—ã¾ã™</span>
  <span class="hljs-keyword">const</span> pizza = <span class="hljs-keyword">await</span> bakePizza(); <span class="hljs-comment">// ãƒ”ã‚¶ã‚’ç„¼ãã¾ã™</span>
  <span class="hljs-keyword">return</span> pizza;
}</code></pre>
<p>Async é–¢æ•°ã®ä¸­ã§ã¯ï¼Œ<code>await</code> ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚ <code>await</code> ã¯ Promise ãŒ Settled ã«ãªã‚‹ã¾ã§å¾…æ©Ÿã—ï¼ŒçµæœãŒå¾—ã‚‰ã‚ŒãŸã‚‰å‡¦ç†ã‚’å†é–‹ã—ã¾ã™ã€‚ã‚‚ã—ã‚‚ãã® Promise ãŒ fulfilled ã¨ãªã£ãŸå ´åˆï¼Œ<code>await</code> ã¯ãã®å€¤ã‚’è¿”ã—ã¾ã™ã€‚ã‚‚ã—ã‚‚ rejected ã¨ãªã£ãŸå ´åˆã¯ãã®ã‚¨ãƒ©ãƒ¼ã‚’ throw ã—ã¾ã™ï¼ˆtry-catch æ§‹æ–‡ã§ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã§ãã¾ã™ï¼‰ã€‚</p>
<p>Async é–¢æ•°ã®çµæœã¯å¸¸ã« Promise ã§ã™ã€‚ã—ãŸãŒã£ã¦ä»¥ä¸‹ã® 2 ã¤ã® Async é–¢æ•°ã¯åŒã˜å€¤ï¼ˆ"ğŸ•"ã® Promiseï¼‰ã‚’è¿”ã—ã¾ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makePizza1</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">"ğŸ•"</span>;
}

<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makePizza2</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.resolve(<span class="hljs-string">"ğŸ•"</span>);
}

<span class="hljs-keyword">const</span> pizza1 = <span class="hljs-keyword">await</span> makePizza1();
<span class="hljs-keyword">const</span> pizza2 = <span class="hljs-keyword">await</span> makePizza2();
<span class="hljs-built_in">console</span>.log(pizza1 === pizza2); <span class="hljs-comment">// true</span></code></pre>
<p><code>await</code> ã¯ Promise ã§ã¯ãªã„å€¤ã‚‚å—ã‘ä»˜ã‘ã¾ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> burger1 = <span class="hljs-keyword">await</span> <span class="hljs-string">"ğŸ”"</span>;
<span class="hljs-keyword">const</span> burger2 = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.resolve(<span class="hljs-string">"ğŸ”"</span>);
<span class="hljs-built_in">console</span>.log(burger1 === burger2); <span class="hljs-comment">// true</span></code></pre>
<h3>ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã¨ <code>await</code></h3>
<p>ã¾ãšæœ€åˆã«ä»¥ä¸‹ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">delayEcho</span>(<span class="hljs-params">x, ms</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =></span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =></span> {
      resolve(x);
    }, ms)
  );
}</code></pre>
<p>å¼•æ•° <code>x</code> ã§æŒ‡å®šã—ãŸå€¤ã‚’å¼•æ•°<code>ms</code> ã§æŒ‡å®šã—ãŸåˆ†ã ã‘å¾…ã£ã¦ resolve ã™ã‚‹ Async é–¢æ•°ã§ã™ã€‚</p>
<p><code>["ğŸ”", "ğŸ•", "ğŸ£"]</code>ã¨ã„ã†é…åˆ—ã‚’ã“ã®é–¢æ•°ã¨<code>.map()</code> ã§å‡¦ç†ã—ãŸã„ã¨ãï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ããŸããªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒï¼Œ<code>.map()</code> ã«æ¸¡ã—ã¦ã„ã‚‹é–¢æ•°ã« <code>async</code> ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒç„¡ã„ãŸã‚ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚¨ãƒ©ãƒ¼ã§ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">delayedFoods</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> foods = [<span class="hljs-string">"ğŸ”"</span>, <span class="hljs-string">"ğŸ•"</span>, <span class="hljs-string">"ğŸ£"</span>];
  <span class="hljs-keyword">return</span> foods.map(<span class="hljs-function"><span class="hljs-params">f</span> =></span> <span class="hljs-keyword">await</span> delayEcho(f, <span class="hljs-number">100</span>)); <span class="hljs-comment">// ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚¨ãƒ©ãƒ¼ ğŸ™…â€â™€ï¸</span>
}

<span class="hljs-keyword">const</span> x = <span class="hljs-keyword">await</span> delayedFoods();
<span class="hljs-built_in">console</span>.log(x);</code></pre>
<p>ã‚³ãƒ¼ãƒ‰ãƒãƒƒã‚¯é–¢æ•°ã«ã‚‚ <code>async</code> ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ã¤ã‘ã‚‹ã¨ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚¨ãƒ©ãƒ¼ã¯ç„¡ããªã‚Šã¾ã™ãŒï¼Œå…ˆã«è¿°ã¹ãŸã¨ãŠã‚Š Async é–¢æ•°ã®è¿”ã‚Šå€¤ã¯ Promise ãªã®ã§ï¼Œæ­£ã—ãå‹•ä½œã™ã‚‹ã«ã¯ï¼Œ<code>Promise.all</code> ã‚’ä½¿ã£ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãã¾ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">delayedFoods</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> foods = [<span class="hljs-string">"ğŸ”"</span>, <span class="hljs-string">"ğŸ•"</span>, <span class="hljs-string">"ğŸ£"</span>];
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.all(foods.map(<span class="hljs-keyword">async</span> f => <span class="hljs-keyword">await</span> delayEcho(f, <span class="hljs-number">100</span>)));
}

<span class="hljs-keyword">const</span> x = <span class="hljs-keyword">await</span> delayedFoods();
<span class="hljs-built_in">console</span>.log(x); <span class="hljs-comment">// ["ğŸ”", "ğŸ•", "ğŸ£"]</span></code></pre>
<p>å®Ÿã¯ã“ã®ä¾‹ã¯ï¼Œ <code>delayEcho</code> ã®çµæœã‚’ <code>await</code> ã™ã‚‹å¿…è¦ã¯ãªãä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãã¨ã‚ˆã‚Šã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">delayedFoods</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> foods = [<span class="hljs-string">"ğŸ”"</span>, <span class="hljs-string">"ğŸ•"</span>, <span class="hljs-string">"ğŸ£"</span>];
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.all(foods.map(<span class="hljs-function"><span class="hljs-params">f</span> =></span> delayEcho(f, <span class="hljs-number">100</span>)));
}</code></pre>
<h2>Async ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
<p>æœ€å¾Œã«ï¼ŒES2018 ã§è¿½åŠ ã•ã‚ŒãŸ Async ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã¿ã¦ã„ãã¾ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">collectFoods</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =></span> <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =></span> resolve(), <span class="hljs-number">1000</span>));
  <span class="hljs-keyword">yield</span> delayEcho(<span class="hljs-string">"ğŸŒ­"</span>, <span class="hljs-number">100</span>);
  <span class="hljs-keyword">yield</span> delayEcho(<span class="hljs-string">"ğŸœ"</span>, <span class="hljs-number">100</span>);
  <span class="hljs-keyword">yield</span> <span class="hljs-string">"ğŸ–"</span>;
}</code></pre>
<p><code>collectFoods</code> ã¯ Async ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿é–¢æ•°ã§ã™ã€‚<code>await</code> ã«åŠ ãˆã¦ <code>yield</code> ã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚<code>collectFoods</code>ã¯ Async iterator ã‚’ä½œæˆã—ã¾ã™ã€‚Async iterator ã¯ <code>.next()</code> ã‚’å‘¼ã³å‡ºã™ã¨çµæœãŒ Promise ã§è¿”ã£ã¦ãã¾ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> asyncIter = collectFoods();
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">await</span> asyncIter.next()); <span class="hljs-comment">// {value: "ğŸŒ­", done: false}</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">await</span> asyncIter.next()); <span class="hljs-comment">// {value: "ğŸœ", done: false}</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">await</span> asyncIter.next()); <span class="hljs-comment">// {value: "ğŸ–", done: false}</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">await</span> asyncIter.next()); <span class="hljs-comment">// {value: undefined, done: true}</span></code></pre>
<p>ã•ã‚‰ã«ï¼ŒAsync Iterator ã®ãƒ«ãƒ¼ãƒ—ã¯ <code>for await...of</code> æ§‹æ–‡ã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> (<span class="hljs-keyword">const</span> food <span class="hljs-keyword">of</span> collectFoods()) {
  <span class="hljs-built_in">console</span>.log(food);
  <span class="hljs-comment">// "ğŸŒ­"</span>
  <span class="hljs-comment">// "ğŸœ"</span>
  <span class="hljs-comment">// "ğŸ–"</span>
}</code></pre>
<p>ã¡ãªã¿ã« <code>for await...of</code> æ§‹æ–‡ã¯ Async ã§ã¯ç„¡ã„é€šå¸¸ã® iterator ã§ã‚‚æ­£å¸¸ã«å‹•ä½œã—ã¾ã™ã€‚</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> (<span class="hljs-keyword">const</span> food <span class="hljs-keyword">of</span> [<span class="hljs-string">'ğŸ'</span>, <span class="hljs-string">'ğŸŠ'</span>, <span class="hljs-built_in">Promise</span>.resolve(<span class="hljs-string">'ğŸ‹'</span>)]) {
  <span class="hljs-built_in">console</span>.log(food);
  <span class="hljs-comment">// ğŸ</span>
  <span class="hljs-comment">// ğŸŠ</span>
  <span class="hljs-comment">// ğŸ‹</span>
}</code></pre>
<h2>ãŠã‚ã‚Šã«</h2>
<p>ä»Šå¹´ã¯ï¼Œåƒ­è¶ŠãªãŒã‚‰å‘¨å›²ã®äººã« JavaScript ã‚’æ•™ãˆã‚‹æ©Ÿä¼šã‚’ã„ãŸã ãã“ã¨ãŒå¤šã„ 1 å¹´ã§ã—ãŸã€‚ç‰¹ã« Promise ã«ã¤ã„ã¦è³ªå•ã•ã‚Œã‚‹ã“ã¨ãŒå¤šã‹ã£ãŸã®ã§ï¼Œã“ã®è¨˜äº‹ã‚’æ›¸ã“ã†ã¨æ€ã„ã¤ãã¾ã—ãŸã€‚æ¥å¹´ã‚‚å…ƒæ°—ã«ã‚„ã£ã¦ã„ãã¾ã™ã®ã§ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ ğŸ‘‹</p>
<h2>å‚è€ƒ</h2>
<ul>
<li><a href="https://exploringjs.com/es2018-es2019/">Exploring ES2018 and ES2019</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/allSettled">Promise.allSettled() - JavaScript | MDN</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/any">Promise.any() - JavaScript | MDN</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for-await...of">for await...of - JavaScript | MDN</a></li>
<li><a href="https://github.com/tc39/proposal-promise-any">tc39/proposal-promise-any: ECMAScript proposal: Promise.any</a></li>
<li><a href="https://github.com/tc39/proposal-async-iteration">tc39/proposal-async-iteration: Asynchronous iteration for JavaScript</a></li>
<li><a href="https://v8.dev/features/promise-combinators">Promise combinators Â· V8</a></li>
</ul>
</div></main><style data-emotion-css="1kv9z39">.css-1kv9z39{width:100%;height:140px;border-top:1px solid #e1e1e1;}</style><footer class="css-1kv9z39"><style data-emotion-css="rp0d16">.css-rp0d16{width:100%;max-width:740px;height:100%;margin:0 auto;font-size:12px;color:#9b9b9b;padding:2rem 0;}</style><div class="css-rp0d16"><style data-emotion-css="1erxk2b">.css-1erxk2b{margin:0 20px;}</style><p class="css-1erxk2b">Â© 2020 chooblarin</p></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postContent":{"title":"2019å¹´ã®Promise","date":"2019-12-01T00:00:00+00:00","slug":"promise-in-2019","tags":["JavaScript"],"draft":false,"content":"\u003cp\u003eã“ã®è¨˜äº‹ã¯\u003ca href=\"https://adventar.org/calendars/4155\"\u003eãƒ•ãƒ©ãƒ¼ Advent Calendar 2019\u003c/a\u003eã® 1 æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚\u003c/p\u003e\n\u003cp\u003eä»Šå¹´ã‚‚ JavaScript (TypeSctipt) ã‚’ãŸãã•ã‚“æ›¸ãã¾ã—ãŸã€‚\u003c/p\u003e\n\u003cp\u003eJavaScript ã«ã¯ ECMAScript ã¨ã„ã†æ¨™æº–ä»•æ§˜ãŒã‚ã‚Šã¾ã™ãŒï¼Œè¿‘å¹´ã§ã¯ TC39 ã«ã‚ˆã£ã¦æ¯å¹´æ–°ã—ã„æ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ã€‚è­°è«–ã®ãƒ—ãƒ­ã‚»ã‚¹ã¯å¸¸ã«ã‚ªãƒ¼ãƒ—ãƒ³ã«ãªã£ã¦ã„ã‚‹ã®ã§èª°ã§ã‚‚é–²è¦§ã§ãã¾ã™ \u003ca href=\"https://github.com/tc39\"\u003e*\u003c/a\u003eã€‚\u003c/p\u003e\n\u003cp\u003eãã—ã¦ä»Šå›ã¯ JavaScript ã®\"Promise\"ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ã¦è¿‘æ³ã‚’è§£èª¬ã—ã¾ã™ã€‚\u003c/p\u003e\n\u003ch2\u003ePromise ã§éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°\u003c/h2\u003e\n\u003cp\u003ePromise ã¯ ES2015 (ES6)ã§æ­£å¼ã«å°å…¥ã•ã‚Œã¾ã—ãŸãŒï¼Œãã‚Œä»¥å‰ã«ã‚‚ JavaScript ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®éåŒæœŸå‡¦ç†ã®ä¸­å¿ƒã«ã„ã¾ã—ãŸã€‚\u003c/p\u003e\n\u003cp\u003eã¾ãšã¯ Promise ã«ã¤ã„ã¦ç°¡å˜ã«å¾©ç¿’ã—ã¾ã—ã‚‡ã†ã€‚ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ Promise ã‚’ç”Ÿæˆã™ã‚‹ä¸€èˆ¬çš„ãªå½¢å¼ã®ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e promise = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eresolve, reject\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  doSomething(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003ex\u003c/span\u003e =\u003e\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (x) {\n      \u003cspan class=\"hljs-comment\"\u003e// æˆåŠŸ\u003c/span\u003e\n      resolve(x);\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      reject(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eError\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"å¤±æ•—ğŸ˜¢\"\u003c/span\u003e));\n    }\n  });\n});\n\n\npromise\n  .then(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eresult\u003c/span\u003e =\u003e\u003c/span\u003e { ... })\n  .catch(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eerror\u003c/span\u003e =\u003e\u003c/span\u003e { ... });\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003edoSomething\u003c/code\u003e ã¯ä½•ã‚‰ã‹ã®éåŒæœŸå‡¦ç†ã‚’è¡Œã„ï¼Œã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã«ã‚ˆã£ã¦çµæœã‚’å¾—ã‚‹é–¢æ•°ã§ã™ã€‚ç„¡äº‹ã«çµæœãŒå¾—ã‚‰ã‚ŒãŸã¨ãã¯ \u003ccode\u003eresolve()\u003c/code\u003e ã‚’ä½¿ã„ã¾ã™ã€‚ã‚‚ã—ã‚‚çµæœãŒå¾—ã‚‰ã‚Œãªã‹ã£ãŸã¨ãã¯ \u003ccode\u003ereject()\u003c/code\u003eã‚’ä½¿ã„ã¾ã™ã€‚\u003c/p\u003e\n\u003cp\u003ePromise ã«ã¯\"pending\", \"fulfilled\", \"rejected\" ã® 3 ã¤ã®çŠ¶æ…‹ãŒå­˜åœ¨ã—ã¾ã™ã€‚å…ˆã»ã©ã®ä¾‹ã§ï¼Œ\u003ccode\u003eresolve()\u003c/code\u003e ã‹ \u003ccode\u003ereject()\u003c/code\u003e ã‚’å‘¼ã³ã ã™å‰ã®çŠ¶æ…‹ã¯ \u003cstrong\u003epending\u003c/strong\u003e çŠ¶æ…‹ã§ã™ã€‚å‘¼ã³å‡ºã—ãŸã‚ã¨ã¯ \u003cstrong\u003efulfilled\u003c/strong\u003e ã‹ \u003cstrong\u003erejected\u003c/strong\u003e ã®ã„ãšã‚Œã‹ã®çŠ¶æ…‹ã«ãªã‚Šã¾ã™ï¼ˆã“ã‚Œã‚’ \u003cstrong\u003eSettled\u003c/strong\u003e ã¨å‘¼ã³ã¾ã™ï¼‰ã€‚\u003c/p\u003e\n\u003cimg src=\"https://user-images.githubusercontent.com/3143302/69895358-261eb400-1371-11ea-9a11-7c88b1a6226d.png\" alt=\"promise has 3 states\" style=\"display:block;margin:0 auto;width:95%;max-width:320px;\"\u003e\n\u003cp\u003ePromise ã¯å¿…ãš 3 ã¤ã®ã†ã¡ã„ãšã‚Œã‹çŠ¶æ…‹ã‚’ã¨ã‚Šã¾ã™ãŒï¼ŒSettled ã«ãªã‚‰ãªã„å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ï¼Œä»¥ä¸‹ã® Promise ã¯æ°¸ä¹…ã« pending çŠ¶æ…‹ã§ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e p = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e {});\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e\u003ccode\u003e.finally()\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eES2018 ã§ã¯ \u003ccode\u003ePromise.prototype.finally()\u003c/code\u003e ãŒå°å…¥ã•ã‚Œã¦ã„ã¾ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003epromise\n  .then(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eresult\u003c/span\u003e =\u003e\u003c/span\u003e { ... })\n  .catch(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eerror\u003c/span\u003e =\u003e\u003c/span\u003e { ... })\n  .finally(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// å¾Œå§‹æœ«ã‚’ã“ã“ã«æ›¸ã\u003c/span\u003e\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003e.finally()\u003c/code\u003eã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã¯ï¼Œfulfilled ã‹ rejected ã‹ã«é–¢ã‚ã‚‰ãšå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚\u003c/p\u003e\n\u003ch2\u003eè¤‡æ•°ã® Promise ã‚’æ“ã‚‹ \u003ccode\u003ePromise.all\u003c/code\u003e ã¨ \u003ccode\u003ePromise.race\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eES2015 ã§ã¯ï¼Œ è¤‡æ•°ã® Promise ã‚’æ“ä½œã™ã‚‹ API \u003ccode\u003ePromise.all\u003c/code\u003e ã¨ \u003ccode\u003ePromise.race\u003c/code\u003e ã® 2 ã¤ãŒå°å…¥ã•ã‚Œã¾ã—ãŸã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ePromise.all\u003c/code\u003eï¼šå…¨ã¦ã® Promise ãŒ fulfilled ã¨ãªã£ãŸçµæœ\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ePromise.race\u003c/code\u003eï¼šã„ãšã‚Œã‹ã® Promise ã®ã†ã¡æœ€åˆã« Settled ã¨ãªã£ãŸçµæœ\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ccode\u003ePromise.all\u003c/code\u003e ã¯è¤‡æ•°ã®éåŒæœŸå‡¦ç†ã‚’åŒæ™‚ã«ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¦ï¼Œå…¨ã¦ãŒå®Œäº†ã—ãŸãã®çµæœã‚’æ‰±ã„ãŸã„ã¨ãã«ä½¿ã„ã¾ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e p1 = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eresolve, reject\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-built_in\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e resolve(\u003cspan class=\"hljs-string\"\u003e\"æˆåŠŸğŸ˜„\"\u003c/span\u003e), \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e);\n});\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e p2 = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eresolve, reject\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-built_in\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e resolve(\u003cspan class=\"hljs-string\"\u003e\"æˆåŠŸğŸ˜\"\u003c/span\u003e), \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e);\n});\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e p3 = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eresolve, reject\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-built_in\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e resolve(\u003cspan class=\"hljs-string\"\u003e\"æˆåŠŸğŸ˜\"\u003c/span\u003e), \u003cspan class=\"hljs-number\"\u003e300\u003c/span\u003e);\n});\n\n\u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e.all([p1, p2, p3])\n  .then(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eresult\u003c/span\u003e =\u003e\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(result)) \u003cspan class=\"hljs-comment\"\u003e// [\"æˆåŠŸğŸ˜„\", \"æˆåŠŸğŸ˜\", \"æˆåŠŸğŸ˜\"]\u003c/span\u003e\n  .catch(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003ee\u003c/span\u003e =\u003e\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(e.message));\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e\u003ccode\u003ePromise.allSettled\u003c/code\u003e ã¨ \u003ccode\u003ePromise.any\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003ePromise.all\u003c/code\u003e ã¯ï¼ŒPromise ãŒ 1 ã¤ã§ã‚‚å¤±æ•—ã—ã¦ \u003ccode\u003erejected\u003c/code\u003e ã«ãªã£ãŸã‚‰ï¼Œãã®çµæœã¯ \u003ccode\u003erejected\u003c/code\u003e ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e p1 = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eresolve, reject\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-built_in\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e resolve(\u003cspan class=\"hljs-string\"\u003e\"æˆåŠŸğŸ˜„\"\u003c/span\u003e), \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e);\n});\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e p2 = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eresolve, reject\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-built_in\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e resolve(\u003cspan class=\"hljs-string\"\u003e\"æˆåŠŸğŸ˜\"\u003c/span\u003e), \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e);\n});\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e p3 = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eresolve, reject\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-built_in\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e reject(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eError\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"å¤±æ•—ğŸ˜­\"\u003c/span\u003e)), \u003cspan class=\"hljs-number\"\u003e300\u003c/span\u003e);\n});\n\n\u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e.all([p1, p2, p3])\n  .then(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eresult\u003c/span\u003e =\u003e\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(result))\n  .catch(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003ee\u003c/span\u003e =\u003e\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(e.message)); \u003cspan class=\"hljs-comment\"\u003e// \"å¤±æ•—ğŸ˜­\"\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eãã“ã§æ–°ãŸã« 2 ã¤ã® API ãŒææ¡ˆã•ã‚Œï¼Œå°å…¥ã•ã‚Œã‚ˆã†ã¨ã—ã¦ã„ã¾ã™ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ePromise.allSettled\u003c/code\u003eï¼šå…¨ã¦ã® Promise ãŒ Settled ã¨ãªã£ãŸçµæœ\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ePromise.any\u003c/code\u003eï¼šã„ãšã‚Œã‹ã® Promise ãŒæœ€åˆã« fulfilled ã¨ãªã£ãŸçµæœã€‚å…¨ã¦ã® Promise ãŒ rejected ã®å ´åˆã«ã®ã¿ï¼Œrejected çŠ¶æ…‹ã«ãªã‚‹ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eå…ˆã»ã©ã®ä¾‹ã‚’ \u003ccode\u003ePromise.allSettled\u003c/code\u003e ã‚’ä½¿ã£ã¦æ›¸ãã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e p1 = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eresolve, reject\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-built_in\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e resolve(\u003cspan class=\"hljs-string\"\u003e\"æˆåŠŸğŸ˜„\"\u003c/span\u003e), \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e);\n});\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e p2 = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eresolve, reject\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-built_in\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e resolve(\u003cspan class=\"hljs-string\"\u003e\"æˆåŠŸğŸ˜\"\u003c/span\u003e), \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e);\n});\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e p3 = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eresolve, reject\u003c/span\u003e) =\u003e\u003c/span\u003e {\n  \u003cspan class=\"hljs-built_in\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e reject(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eError\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"å¤±æ•—ğŸ˜­\"\u003c/span\u003e)), \u003cspan class=\"hljs-number\"\u003e300\u003c/span\u003e);\n});\n\n\u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e.allSettled([p1, p2, p3])\n  .then(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eresult\u003c/span\u003e =\u003e\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(result.map(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003er\u003c/span\u003e =\u003e\u003c/span\u003e r.value))) \u003cspan class=\"hljs-comment\"\u003e// [\"æˆåŠŸğŸ˜„\", \"æˆåŠŸğŸ˜\", undefined]\u003c/span\u003e\n  .catch(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003ee\u003c/span\u003e =\u003e\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(e.message));\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e\u003ccode\u003easync\u003c/code\u003e / \u003ccode\u003eawait\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eES2017 ã§è¿½åŠ ã•ã‚ŒãŸ Async é–¢æ•°ã‚’ä½¿ã†ã¨ï¼ŒPromise ã‚’æ›´ã«æ‰±ã„ã‚„ã™ããªã‚Šã¾ã™ã€‚Async é–¢æ•°ã¯ä»¥ä¸‹ã®ã‚ˆã†ã« \u003ccode\u003easync\u003c/code\u003e ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒã¤ã„ãŸé–¢æ•°ã§ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emakePizza\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e ingredients = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e prepareIngredients(); \u003cspan class=\"hljs-comment\"\u003e// ææ–™ã‚’ç”¨æ„ã—ã¾ã™\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e pizza = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e bakePizza(); \u003cspan class=\"hljs-comment\"\u003e// ãƒ”ã‚¶ã‚’ç„¼ãã¾ã™\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e pizza;\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAsync é–¢æ•°ã®ä¸­ã§ã¯ï¼Œ\u003ccode\u003eawait\u003c/code\u003e ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚ \u003ccode\u003eawait\u003c/code\u003e ã¯ Promise ãŒ Settled ã«ãªã‚‹ã¾ã§å¾…æ©Ÿã—ï¼ŒçµæœãŒå¾—ã‚‰ã‚ŒãŸã‚‰å‡¦ç†ã‚’å†é–‹ã—ã¾ã™ã€‚ã‚‚ã—ã‚‚ãã® Promise ãŒ fulfilled ã¨ãªã£ãŸå ´åˆï¼Œ\u003ccode\u003eawait\u003c/code\u003e ã¯ãã®å€¤ã‚’è¿”ã—ã¾ã™ã€‚ã‚‚ã—ã‚‚ rejected ã¨ãªã£ãŸå ´åˆã¯ãã®ã‚¨ãƒ©ãƒ¼ã‚’ throw ã—ã¾ã™ï¼ˆtry-catch æ§‹æ–‡ã§ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã§ãã¾ã™ï¼‰ã€‚\u003c/p\u003e\n\u003cp\u003eAsync é–¢æ•°ã®çµæœã¯å¸¸ã« Promise ã§ã™ã€‚ã—ãŸãŒã£ã¦ä»¥ä¸‹ã® 2 ã¤ã® Async é–¢æ•°ã¯åŒã˜å€¤ï¼ˆ\"ğŸ•\"ã® Promiseï¼‰ã‚’è¿”ã—ã¾ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emakePizza1\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"ğŸ•\"\u003c/span\u003e;\n}\n\n\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emakePizza2\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e.resolve(\u003cspan class=\"hljs-string\"\u003e\"ğŸ•\"\u003c/span\u003e);\n}\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e pizza1 = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e makePizza1();\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e pizza2 = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e makePizza2();\n\u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(pizza1 === pizza2); \u003cspan class=\"hljs-comment\"\u003e// true\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003eawait\u003c/code\u003e ã¯ Promise ã§ã¯ãªã„å€¤ã‚‚å—ã‘ä»˜ã‘ã¾ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e burger1 = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"ğŸ”\"\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e burger2 = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e.resolve(\u003cspan class=\"hljs-string\"\u003e\"ğŸ”\"\u003c/span\u003e);\n\u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(burger1 === burger2); \u003cspan class=\"hljs-comment\"\u003e// true\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã¨ \u003ccode\u003eawait\u003c/code\u003e\u003c/h3\u003e\n\u003cp\u003eã¾ãšæœ€åˆã«ä»¥ä¸‹ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã‚’å®šç¾©ã—ã¾ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003edelayEcho\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003ex, ms\u003c/span\u003e) \u003c/span\u003e{\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eresolve\u003c/span\u003e =\u003e\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e {\n      resolve(x);\n    }, ms)\n  );\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eå¼•æ•° \u003ccode\u003ex\u003c/code\u003e ã§æŒ‡å®šã—ãŸå€¤ã‚’å¼•æ•°\u003ccode\u003ems\u003c/code\u003e ã§æŒ‡å®šã—ãŸåˆ†ã ã‘å¾…ã£ã¦ resolve ã™ã‚‹ Async é–¢æ•°ã§ã™ã€‚\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e[\"ğŸ”\", \"ğŸ•\", \"ğŸ£\"]\u003c/code\u003eã¨ã„ã†é…åˆ—ã‚’ã“ã®é–¢æ•°ã¨\u003ccode\u003e.map()\u003c/code\u003e ã§å‡¦ç†ã—ãŸã„ã¨ãï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ããŸããªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒï¼Œ\u003ccode\u003e.map()\u003c/code\u003e ã«æ¸¡ã—ã¦ã„ã‚‹é–¢æ•°ã« \u003ccode\u003easync\u003c/code\u003e ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒç„¡ã„ãŸã‚ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚¨ãƒ©ãƒ¼ã§ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003edelayedFoods\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e foods = [\u003cspan class=\"hljs-string\"\u003e\"ğŸ”\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"ğŸ•\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"ğŸ£\"\u003c/span\u003e];\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e foods.map(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003ef\u003c/span\u003e =\u003e\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e delayEcho(f, \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e)); \u003cspan class=\"hljs-comment\"\u003e// ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚¨ãƒ©ãƒ¼ ğŸ™…â€â™€ï¸\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e x = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e delayedFoods();\n\u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(x);\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eã‚³ãƒ¼ãƒ‰ãƒãƒƒã‚¯é–¢æ•°ã«ã‚‚ \u003ccode\u003easync\u003c/code\u003e ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ã¤ã‘ã‚‹ã¨ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚¨ãƒ©ãƒ¼ã¯ç„¡ããªã‚Šã¾ã™ãŒï¼Œå…ˆã«è¿°ã¹ãŸã¨ãŠã‚Š Async é–¢æ•°ã®è¿”ã‚Šå€¤ã¯ Promise ãªã®ã§ï¼Œæ­£ã—ãå‹•ä½œã™ã‚‹ã«ã¯ï¼Œ\u003ccode\u003ePromise.all\u003c/code\u003e ã‚’ä½¿ã£ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãã¾ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003edelayedFoods\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e foods = [\u003cspan class=\"hljs-string\"\u003e\"ğŸ”\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"ğŸ•\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"ğŸ£\"\u003c/span\u003e];\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e.all(foods.map(\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e f =\u003e \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e delayEcho(f, \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e)));\n}\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e x = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e delayedFoods();\n\u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(x); \u003cspan class=\"hljs-comment\"\u003e// [\"ğŸ”\", \"ğŸ•\", \"ğŸ£\"]\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eå®Ÿã¯ã“ã®ä¾‹ã¯ï¼Œ \u003ccode\u003edelayEcho\u003c/code\u003e ã®çµæœã‚’ \u003ccode\u003eawait\u003c/code\u003e ã™ã‚‹å¿…è¦ã¯ãªãä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãã¨ã‚ˆã‚Šã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003edelayedFoods\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e foods = [\u003cspan class=\"hljs-string\"\u003e\"ğŸ”\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"ğŸ•\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"ğŸ£\"\u003c/span\u003e];\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e.all(foods.map(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003ef\u003c/span\u003e =\u003e\u003c/span\u003e delayEcho(f, \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e)));\n}\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eAsync ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³\u003c/h2\u003e\n\u003cp\u003eæœ€å¾Œã«ï¼ŒES2018 ã§è¿½åŠ ã•ã‚ŒãŸ Async ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã¿ã¦ã„ãã¾ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e* \u003cspan class=\"hljs-title\"\u003ecollectFoods\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n  \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003eresolve\u003c/span\u003e =\u003e\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e resolve(), \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e));\n  \u003cspan class=\"hljs-keyword\"\u003eyield\u003c/span\u003e delayEcho(\u003cspan class=\"hljs-string\"\u003e\"ğŸŒ­\"\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e);\n  \u003cspan class=\"hljs-keyword\"\u003eyield\u003c/span\u003e delayEcho(\u003cspan class=\"hljs-string\"\u003e\"ğŸœ\"\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e);\n  \u003cspan class=\"hljs-keyword\"\u003eyield\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"ğŸ–\"\u003c/span\u003e;\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003ecollectFoods\u003c/code\u003e ã¯ Async ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿é–¢æ•°ã§ã™ã€‚\u003ccode\u003eawait\u003c/code\u003e ã«åŠ ãˆã¦ \u003ccode\u003eyield\u003c/code\u003e ã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚\u003ccode\u003ecollectFoods\u003c/code\u003eã¯ Async iterator ã‚’ä½œæˆã—ã¾ã™ã€‚Async iterator ã¯ \u003ccode\u003e.next()\u003c/code\u003e ã‚’å‘¼ã³å‡ºã™ã¨çµæœãŒ Promise ã§è¿”ã£ã¦ãã¾ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e asyncIter = collectFoods();\n\u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(\u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e asyncIter.next()); \u003cspan class=\"hljs-comment\"\u003e// {value: \"ğŸŒ­\", done: false}\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(\u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e asyncIter.next()); \u003cspan class=\"hljs-comment\"\u003e// {value: \"ğŸœ\", done: false}\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(\u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e asyncIter.next()); \u003cspan class=\"hljs-comment\"\u003e// {value: \"ğŸ–\", done: false}\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(\u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e asyncIter.next()); \u003cspan class=\"hljs-comment\"\u003e// {value: undefined, done: true}\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eã•ã‚‰ã«ï¼ŒAsync Iterator ã®ãƒ«ãƒ¼ãƒ—ã¯ \u003ccode\u003efor await...of\u003c/code\u003e æ§‹æ–‡ã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e food \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e collectFoods()) {\n  \u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(food);\n  \u003cspan class=\"hljs-comment\"\u003e// \"ğŸŒ­\"\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// \"ğŸœ\"\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// \"ğŸ–\"\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eã¡ãªã¿ã« \u003ccode\u003efor await...of\u003c/code\u003e æ§‹æ–‡ã¯ Async ã§ã¯ç„¡ã„é€šå¸¸ã® iterator ã§ã‚‚æ­£å¸¸ã«å‹•ä½œã—ã¾ã™ã€‚\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e food \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e [\u003cspan class=\"hljs-string\"\u003e'ğŸ'\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e'ğŸŠ'\u003c/span\u003e, \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e.resolve(\u003cspan class=\"hljs-string\"\u003e'ğŸ‹'\u003c/span\u003e)]) {\n  \u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(food);\n  \u003cspan class=\"hljs-comment\"\u003e// ğŸ\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// ğŸŠ\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// ğŸ‹\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eãŠã‚ã‚Šã«\u003c/h2\u003e\n\u003cp\u003eä»Šå¹´ã¯ï¼Œåƒ­è¶ŠãªãŒã‚‰å‘¨å›²ã®äººã« JavaScript ã‚’æ•™ãˆã‚‹æ©Ÿä¼šã‚’ã„ãŸã ãã“ã¨ãŒå¤šã„ 1 å¹´ã§ã—ãŸã€‚ç‰¹ã« Promise ã«ã¤ã„ã¦è³ªå•ã•ã‚Œã‚‹ã“ã¨ãŒå¤šã‹ã£ãŸã®ã§ï¼Œã“ã®è¨˜äº‹ã‚’æ›¸ã“ã†ã¨æ€ã„ã¤ãã¾ã—ãŸã€‚æ¥å¹´ã‚‚å…ƒæ°—ã«ã‚„ã£ã¦ã„ãã¾ã™ã®ã§ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ ğŸ‘‹\u003c/p\u003e\n\u003ch2\u003eå‚è€ƒ\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://exploringjs.com/es2018-es2019/\"\u003eExploring ES2018 and ES2019\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/allSettled\"\u003ePromise.allSettled() - JavaScript | MDN\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/any\"\u003ePromise.any() - JavaScript | MDN\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for-await...of\"\u003efor await...of - JavaScript | MDN\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-promise-any\"\u003etc39/proposal-promise-any: ECMAScript proposal: Promise.any\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/tc39/proposal-async-iteration\"\u003etc39/proposal-async-iteration: Asynchronous iteration for JavaScript\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://v8.dev/features/promise-combinators\"\u003ePromise combinators Â· V8\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n"}},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"promise-in-2019"},"buildId":"xR1PmG82fnEDyoPeX5uTG","nextExport":false,"isFallback":false,"gsp":true,"head":[["meta",{"name":"viewport","content":"width=device-width"}],["meta",{"charSet":"utf-8"}],["meta",{"name":"description","content":"Sympathy driven development"}],["meta",{"property":"og:url","content":"https://chooblarin.github.io"}],["meta",{"property":"og:type","content":"website"}],["meta",{"property":"og:description","content":"Sympathy driven development"}],["meta",{"property":"og:image","content":"og-default.png"}],["meta",{"property":"og:image:alt","content":"chooblarin's blog"}],["meta",{"property":"og:image:width","content":"1280"}],["meta",{"property":"og:image:height","content":"675"}],["meta",{"property":"og:site_name","content":"chooblarin's blog"}],["meta",{"name":"google-site-verification","content":"5MMy9toPN2P8O6xmRyiBp-l97-pCGSnLGS2AwiUdWpI"}],["title",{"children":"2019å¹´ã®Promise | chooblarin's blog"}],["meta",{"name":"robots","content":"index,follow"}],["meta",{"name":"googlebot","content":"index,follow"}],["meta",{"property":"og:title","content":"2019å¹´ã®Promise"}],["script",{"async":true,"src":"https://platform.twitter.com/widgets.js","charSet":"utf-8"}],["script",{"async":true,"src":"https://static.codepen.io/assets/embed/ei.js","charSet":"utf-8"}],["script",{"async":true,"src":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML","charSet":"utf-8"}],["script",{"type":"text/x-mathjax-config","dangerouslySetInnerHTML":{"__html":"\nMathJax.Hub.Config({\n  tex2jax: {\n    inlineMath: [['$','$']],\n    displayMath: [['$$','$$']],\n    extensions: [\"[Contrib]/a11y/accessibility-menu.js\"],\n    menuSettings: {\n      collapsible: true,\n      autocollapse: true,\n      explorer: true\n    },\n    processEscapes: true\n  },\n  CommonHTML: { matchFontHeight: false },\n  displayAlign: \"left\",\n  displayIndent: \"2em\"\n});\n"}}]]}</script><script nomodule="" src="/_next/static/chunks/polyfills-608493d412e67f440912.js"></script><script src="/_next/static/chunks/main-e57adab046a48d87f0b6.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.1cc9dd07c455eb544511.js" async=""></script><script src="/_next/static/chunks/f1c7a11d82ab5aeae255133ab9a9dd72095cfbe8.ace57a9ae52ca0c4aaff.js" async=""></script><script src="/_next/static/chunks/be0ee40335aab5b90e46c407218b7ebff3be96c3.f5754105fd8cc37bf292.js" async=""></script><script src="/_next/static/chunks/af34e2db61f97cedc6ebfbaa0d751a83f9f0d9f6.585b1c552b574c6100a9.js" async=""></script><script src="/_next/static/chunks/pages/_app-c63aeeb3735b54a66118.js" async=""></script><script src="/_next/static/chunks/305bf1217467fbfb8d27f2d195337c27f206dc2e.181a12ddc8dc3a759259.js" async=""></script><script src="/_next/static/chunks/dc565b348471f1cc9a369b64c164a9c4498f98d4.5a431597bfee0da91e6a.js" async=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-bc4663299dd8234d2279.js" async=""></script><script src="/_next/static/xR1PmG82fnEDyoPeX5uTG/_buildManifest.js" async=""></script><script src="/_next/static/xR1PmG82fnEDyoPeX5uTG/_ssgManifest.js" async=""></script></body></html>